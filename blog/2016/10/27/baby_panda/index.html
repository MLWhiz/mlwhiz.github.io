<!doctype html><html lang=en-us><head><script async src="https://www.googletagmanager.com/gtag/js?id=G-F34XSWQ5N4"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag('js',new Date),gtag('config','G-F34XSWQ5N4')</script><meta charset=utf-8><title>Pandas For All - Some Basic Pandas Functions - MLWhiz</title><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1"><meta name=description content="This post provides a description and practical use case for most used functions in the pandas library"><meta name=author content="Rahul Agarwal"><meta name=generator content="Hugo 0.82.0"><link rel=stylesheet href=https://mlwhiz.com/plugins/compressjscss/main.css><meta property="og:title" content="Pandas For All - Some Basic Pandas Functions - MLWhiz"><meta property="og:description" content="This post provides a description and practical use case for most used functions in the pandas library"><meta property="og:type" content="article"><meta property="og:url" content="https://mlwhiz.com/blog/2016/10/27/baby_panda/"><meta property="og:image" content="https://mlwhiz.com/images/category_bgs/default_bg.jpg"><meta property="og:image:secure_url" content="https://mlwhiz.com/images/category_bgs/default_bg.jpg"><meta property="article:published_time" content="2016-10-27T00:00:00+00:00"><meta property="article:modified_time" content="2023-08-13T22:36:49+01:00"><meta property="article:tag" content="Data Science"><meta name=twitter:card content="summary"><meta name=twitter:image content="https://mlwhiz.com/images/category_bgs/default_bg.jpg"><meta name=twitter:title content="Pandas For All - Some Basic Pandas Functions - MLWhiz"><meta name=twitter:description content="This post provides a description and practical use case for most used functions in the pandas library"><meta name=twitter:site content="@mlwhiz"><meta name=twitter:creator content="@mlwhiz"><link rel=dns-prefetch href=//fonts.googleapis.com><link rel=dns-prefetch href=//fonts.gstatic.com><link rel=stylesheet href=https://mlwhiz.com/scss/style.min.css media=screen><link rel=stylesheet href=/css/style.css><link rel=stylesheet type=text/css href=/css/font/flaticon.css><link rel="shortcut icon" href=https://mlwhiz.com/images/logos/favicon-32x32.png type=image/x-icon><link rel=icon href=https://mlwhiz.com/images/logos/favicon.ico type=image/x-icon><link rel=canonical href=https://mlwhiz.com/blog/2016/10/27/baby_panda/><script src=https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js></script><script type=application/ld+json>{"@context":"https://schema.org","@graph":[{"@type":"WebSite","@id":"https://www.mlwhiz.com/#website","url":"https://www.mlwhiz.com/","name":"MLWhiz","description":"Want to Learn Computer Vision and NLP? - MLWhiz","potentialAction":{"@type":"SearchAction","target":"https://www.mlwhiz.com/search?s={search_term_string}","query-input":"required name=search_term_string"}},{"@type":"ImageObject","@id":"https://mlwhiz.com/blog/2016/10/27/baby_panda/#primaryimage","url":"https://mlwhiz.com/images/category_bgs/default_bg.jpg","width":700,"height":450},{"@type":"WebPage","@id":"https://mlwhiz.com/blog/2016/10/27/baby_panda/#webpage","url":"https://mlwhiz.com/blog/2016/10/27/baby_panda/","inLanguage":"en-US","name":"Pandas For All - Some Basic Pandas Functions - MLWhiz","isPartOf":{"@id":"https://www.mlwhiz.com/#website"},"primaryImageOfPage":{"@id":"https://mlwhiz.com/blog/2016/10/27/baby_panda/#primaryimage"},"datePublished":"2016-10-27T00:00:00.00Z","dateModified":"2023-08-13T22:36:49.00Z","author":{"@id":"https://mlwhiz.com/about/#/schema/person/76376876bchxkzbchjsdjcca"},"description":"This post provides a description and practical use case for most used functions in the pandas library"},{"@type":["Person"],"@id":"https://mlwhiz.com/about/#/schema/person/76376876bchxkzbchjsdjcca","name":"Rahul Agarwal","image":{"@type":"ImageObject","@id":"https://www.mlwhiz.com/#authorlogo","url":"https://mlwhiz.com/images/author.jpg","caption":"Rahul Agarwal"},"description":"Hi there, I\u2019m Rahul Agarwal. I\u2019m a data scientist consultant and big data engineer based in Bangalore. I see a lot of times  students and even professionals wasting their time and struggling to get started with Computer Vision, Deep Learning, and NLP. I Started this Site with a purpose to augment my own understanding about new things while helping others learn about them in the best possible way.","sameAs":["https://www.linkedin.com/in/rahulagwl/","https://medium.com/@rahul_agarwal","https://twitter.com/MLWhiz","https://www.facebook.com/mlwhizblog","https://github.com/MLWhiz","https://www.instagram.com/itsmlwhiz"]}]}</script><script async data-uid=a0ebaf958d src=https://mlwhiz.ck.page/a0ebaf958d/index.js></script><script type=text/javascript async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML">MathJax.Hub.Config({tex2jax:{inlineMath:[['$','$'],['\\(','\\)']],displayMath:[['$$','$$']],processEscapes:!0,processEnvironments:!0,skipTags:['script','noscript','style','textarea','pre'],TeX:{equationNumbers:{autoNumber:"AMS"},extensions:["AMSmath.js","AMSsymbols.js"]}}}),MathJax.Hub.Queue(function(){var b=MathJax.Hub.getAllJax(),a;for(a=0;a<b.length;a+=1)b[a].SourceElement().parentNode.className+=' has-jax'}),MathJax.Hub.Config({TeX:{equationNumbers:{autoNumber:"AMS"}}})</script><link href=//apps.shareaholic.com/assets/pub/shareaholic.js as=script><script type=text/javascript data-cfasync=false async src=//apps.shareaholic.com/assets/pub/shareaholic.js data-shr-siteid=fd1ffa7fd7152e4e20568fbe49a489d0></script><script>!function(b,e,f,g,a,c,d){if(b.fbq)return;a=b.fbq=function(){a.callMethod?a.callMethod.apply(a,arguments):a.queue.push(arguments)},b._fbq||(b._fbq=a),a.push=a,a.loaded=!0,a.version='2.0',a.queue=[],c=e.createElement(f),c.async=!0,c.src=g,d=e.getElementsByTagName(f)[0],d.parentNode.insertBefore(c,d)}(window,document,'script','https://connect.facebook.net/en_US/fbevents.js'),fbq('init','402633927768628'),fbq('track','PageView')</script><noscript><img height=1 width=1 style=display:none src="https://www.facebook.com/tr?id=402633927768628&ev=PageView&noscript=1"></noscript><meta property="fb:pages" content="213104036293742"><meta name=facebook-domain-verification content="qciidcy7mm137sewruizlvh8zbfnv4"></head><body><noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-NMQD44T" height=0 width=0 style=display:none;visibility:hidden></iframe></noscript><div class=preloader></div><header class=navigation><div class=container><nav class="navbar navbar-expand-lg navbar-white bg-transparent border-bottom pl-0"><a class="navbar-brand mobile-view" href=https://mlwhiz.com/><img class=img-fluid src=https://mlwhiz.com/images/logos/logo.svg alt="MLWhiz - Your Home for DS, ML, AI!"></a>
<button class="navbar-toggler border-0" type=button data-toggle=collapse data-target=#navigation>
<i class="ti-menu h3"></i></button><div class="collapse navbar-collapse text-center" id=navigation><div class=desktop-view><ul class="navbar-nav mr-auto"><li class=nav-item><a class=nav-link href="https://linkedin.com/comm/mynetwork/discovery-see-all?usecase=PEOPLE_FOLLOWS&followMember=rahulagwl"><i class=ti-linkedin></i></a></li><li class=nav-item><a class=nav-link href=https://mlwhiz.medium.com/><i class=ti-book></i></a></li><li class=nav-item><a class=nav-link href=https://twitter.com/MLWhiz><i class=ti-twitter-alt></i></a></li><li class=nav-item><a class=nav-link href=https://www.facebook.com/mlwhizblog><i class=ti-facebook></i></a></li><li class=nav-item><a class=nav-link href=https://github.com/MLWhiz><i class=ti-github></i></a></li></ul></div><a class="navbar-brand mx-auto desktop-view" href=https://mlwhiz.com/><img class=img-fluid-custom src=https://mlwhiz.com/images/logos/logo.svg alt="MLWhiz - Your Home for DS, ML, AI!"></a><ul class=navbar-nav><li class=nav-item><a class=nav-link href=https://mlwhiz.com/about>About</a></li><li class=nav-item><a class=nav-link href=https://mlwhiz.com/blog>Blog</a></li><li class="nav-item dropdown"><a class="nav-link dropdown-toggle" href=# role=button data-toggle=dropdown aria-haspopup=true aria-expanded=false>Topics</a><div class=dropdown-menu><a class=dropdown-item href=https://mlwhiz.com/categories/natural-language-processing>NLP</a>
<a class=dropdown-item href=https://mlwhiz.com/categories/computer-vision>Computer Vision</a>
<a class=dropdown-item href=https://mlwhiz.com/categories/deep-learning>Deep Learning</a>
<a class=dropdown-item href=https://mlwhiz.com/categories/data-science>DS/ML</a>
<a class=dropdown-item href=https://mlwhiz.com/categories/big-data>Big Data</a>
<a class=dropdown-item href=https://mlwhiz.com/categories/awesome-guides>My Best Content</a>
<a class=dropdown-item href=https://mlwhiz.com/categories/learning-resources>Learning Resources</a></div></li></ul><div class="search pl-lg-4"><button id=searchOpen class=search-btn><i class=ti-search></i></button><div class=search-wrapper><form action=https://mlwhiz.com//search class=h-100><input class="search-box px-4" id=search-query name=s type=search placeholder="Type & Hit Enter..."></form><button id=searchClose class=search-close><i class="ti-close text-dark"></i></button></div></div></div></nav></div></header><section class=section-sm><div class=container><div class=row><div class="col-lg-8 mb-5 mb-lg-0"><a href=/categories/data-science class=categoryStyle>Data Science</a><h1>Pandas For All - Some Basic Pandas Functions</h1><div class="mb-3 post-meta"><span>By Rahul Agarwal</span><svg class="meta__icon icon icon-time" width="16" height="14" viewBox="0 0 30 28"><path d="M15 0C7 0 1 6 1 14s6 14 14 14 14-6 14-14S23 0 15 0zm0 25C9 25 4 20 4 14S9 3 15 3s11 5 11 11-5 11-11 11zm1-18h-2v8.4l6.8 4.4L22 18l-6-3.8V7z"/></svg>
<span>27 October 2016</span></div><img src=https://mlwhiz.com/images/category_bgs/default_bg.jpg class="img-fluid w-100 mb-4" alt="Pandas For All - Some Basic Pandas Functions"><div class="content mb-5"><p>It has been quite a few days I have been working with Pandas and apparently I feel I have gotten quite good at it. (Quite a Braggard I know)
So thought about adding a post about Pandas usage here. I intend to make this post quite practical and since I find the pandas syntax quite self explanatory, I won&rsquo;t be explaining much of the codes. Just the use cases and the code to achieve them.</p><h2 id=1-import-pandas>1. Import Pandas</h2><p>We Start by importing the libraries that we will need to use.</p><div class=highlight><pre style=color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-py data-lang=py><span style=color:#6ab825;font-weight:700>import</span> <span style=color:#447fcf;text-decoration:underline>pandas</span> <span style=color:#6ab825;font-weight:700>as</span> <span style=color:#447fcf;text-decoration:underline>pd</span>
</code></pre></div><h2 id=2-read-a-datasource>2. Read a Datasource:</h2><div class=highlight><pre style=color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-py data-lang=py><span style=color:#999;font-style:italic># Read from csv data files</span>

<span style=color:#999;font-style:italic># With Header</span>
df = pd.read_csv(<span style=color:#ed9d13>&#34;/Users/ragarw5/Downloads/SalesJan2009.csv&#34;</span>)

<span style=color:#999;font-style:italic># Without Header. sep param to provide the delimiter</span>
df = pd.read_csv(<span style=color:#ed9d13>&#34;/Users/ragarw5/Downloads/SalesJan2009.csv&#34;</span>, header=None, sep= <span style=color:#ed9d13>&#34;,&#34;</span>)

<span style=color:#999;font-style:italic># Reading from SQL Datasource</span>

<span style=color:#6ab825;font-weight:700>import</span> <span style=color:#447fcf;text-decoration:underline>MySQLdb</span>
<span style=color:#6ab825;font-weight:700>from</span> <span style=color:#447fcf;text-decoration:underline>pandas</span> <span style=color:#6ab825;font-weight:700>import</span> DataFrame
<span style=color:#6ab825;font-weight:700>from</span> <span style=color:#447fcf;text-decoration:underline>pandas.io.sql</span> <span style=color:#6ab825;font-weight:700>import</span> read_sql

db = MySQLdb.connect(host=<span style=color:#ed9d13>&#34;localhost&#34;</span>,    <span style=color:#999;font-style:italic># your host, usually localhost</span>
                     user=<span style=color:#ed9d13>&#34;root&#34;</span>,         <span style=color:#999;font-style:italic># your username</span>
                     passwd=<span style=color:#ed9d13>&#34;password&#34;</span>,   <span style=color:#999;font-style:italic># your password</span>
                     db=<span style=color:#ed9d13>&#34;dbname&#34;</span>)         <span style=color:#999;font-style:italic># name of the data base</span>

query = <span style=color:#ed9d13>&#34;SELECT * FROM tablename&#34;</span>

data = read_sql(query, db)

<span style=color:#999;font-style:italic># Reading from ExcelFile</span>
data = pd.read_excel(filename)
</code></pre></div><p>For now, we will be working with the file at <a href=http://samplecsvs.s3.amazonaws.com/SalesJan2009.csv>http://samplecsvs.s3.amazonaws.com/SalesJan2009.csv</a>. The Sales Jan 2009 file contains some “sanitized” sales transactions during the month of January. If you want to work along you can download this file from that location.</p><div class=highlight><pre style=color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-py data-lang=py>df = pd.read_csv(<span style=color:#ed9d13>&#34;/Users/ragarw5/Downloads/SalesJan2009.csv&#34;</span>)
</code></pre></div><h2 id=3-see-few-rows-of-data>3. See few rows of data:</h2><div class=highlight><pre style=color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-py data-lang=py><span style=color:#999;font-style:italic># top 5 rows</span>
df.head()

<span style=color:#999;font-style:italic># top 50 rows</span>
df.head(<span style=color:#3677a9>50</span>)

<span style=color:#999;font-style:italic># last 5 rows</span>
df.tail()

<span style=color:#999;font-style:italic># last 50 rows</span>
df.tail(<span style=color:#3677a9>50</span>)
</code></pre></div><h2 id=4-getting-column-names-in-a-list>4. Getting Column Names in a list:</h2><div class=highlight><pre style=color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-py data-lang=py>columnnames = df.columns
</code></pre></div><h2 id=5-specifying-user-defined-column-names>5. Specifying user defined Column Names:</h2><p>Sometimes you want to change the column names:</p><div class=highlight><pre style=color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-py data-lang=py>df.columns = [<span style=color:#ed9d13>&#39;Transdate&#39;</span>, <span style=color:#ed9d13>&#39;Product&#39;</span>, <span style=color:#ed9d13>&#39;Price&#39;</span>, <span style=color:#ed9d13>&#39;PaymentType&#39;</span>, <span style=color:#ed9d13>&#39;Name&#39;</span>,
       <span style=color:#ed9d13>&#39;City&#39;</span>, <span style=color:#ed9d13>&#39;State&#39;</span>, <span style=color:#ed9d13>&#39;Country&#39;</span>, <span style=color:#ed9d13>&#39;AccountCreated&#39;</span>, <span style=color:#ed9d13>&#39;LastLogin&#39;</span>,
       <span style=color:#ed9d13>&#39;Latitude&#39;</span>, <span style=color:#ed9d13>&#39;Longitude&#39;</span>]
</code></pre></div><h2 id=6-subsetting-specific-columns>6. Subsetting specific columns:</h2><p>Sometimes you only need to work with specific columns in a dataframe only. You can subset the columns in the dataframe using</p><div class=highlight><pre style=color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-py data-lang=py>newDf = df[[<span style=color:#ed9d13>&#39;Product&#39;</span>, <span style=color:#ed9d13>&#39;Price&#39;</span>, <span style=color:#ed9d13>&#39;PaymentType&#39;</span>, <span style=color:#ed9d13>&#39;Name&#39;</span>, <span style=color:#ed9d13>&#39;City&#39;</span>, <span style=color:#ed9d13>&#39;State&#39;</span>, <span style=color:#ed9d13>&#39;Country&#39;</span>]]
</code></pre></div><h2 id=7-seeing-column-types>7. Seeing column types:</h2><div class=highlight><pre style=color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-py data-lang=py>newDf.dtypes
</code></pre></div><h2 id=8-change-type-of-a-column>8. Change type of a column</h2><p>First thing i try is this.</p><div class=highlight><pre style=color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-py data-lang=py>newDf[<span style=color:#ed9d13>&#39;Price&#39;</span>] = newDf[<span style=color:#ed9d13>&#39;Price&#39;</span>].astype(<span style=color:#ed9d13>&#39;int&#39;</span>)
</code></pre></div><p>It gives error : ValueError: invalid literal for long() with base 10: &lsquo;13,000&rsquo;. That is you cannot cast a string with &ldquo;,&rdquo; to an int. To do that we first have to get rid of the comma. For that we use a particular lambda-apply functionality which lets us apply functions to each row in the data.</p><div class=highlight><pre style=color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-py data-lang=py>newDf[<span style=color:#ed9d13>&#39;Price&#39;</span>] = newDf.apply(<span style=color:#6ab825;font-weight:700>lambda</span> x: <span style=color:#24909d>int</span>(x[<span style=color:#ed9d13>&#39;Price&#39;</span>].replace(<span style=color:#ed9d13>&#39;,&#39;</span>, <span style=color:#ed9d13>&#39;&#39;</span>)),axis=<span style=color:#3677a9>1</span>)
</code></pre></div><script src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&adInstanceId=c4ca54df-6d53-4362-92c0-13cb9977639e"></script><h2 id=9-simple-dataframe-statistics>9. Simple Dataframe Statistics:</h2><div class=highlight><pre style=color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-py data-lang=py><span style=color:#999;font-style:italic># To get statistics of numerical columns</span>
newDf.describe()

<span style=color:#999;font-style:italic># To get maximum value of a column. When you take a single column you can think of it as a list and apply functions you would apply to a list</span>
<span style=color:#24909d>max</span>(newDf[<span style=color:#ed9d13>&#39;Price&#39;</span>])

<span style=color:#999;font-style:italic># no of rows in dataframe</span>
<span style=color:#24909d>len</span>(newDf)

<span style=color:#999;font-style:italic># Shape of Dataframe</span>
newDf.shape
</code></pre></div><h2 id=10-creating-a-new-column>10. Creating a new column:</h2><div class=highlight><pre style=color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-py data-lang=py><span style=color:#999;font-style:italic># Create a column Address containing City,State and Country. Simply concat the columns.</span>
newDf[<span style=color:#ed9d13>&#39;Address&#39;</span>] = newDf[<span style=color:#ed9d13>&#39;City&#39;</span>] +<span style=color:#ed9d13>&#34;,&#34;</span>+ newDf[<span style=color:#ed9d13>&#39;State&#39;</span>] +<span style=color:#ed9d13>&#34;,&#34;</span>+ newDf[<span style=color:#ed9d13>&#39;Country&#39;</span>]

<span style=color:#999;font-style:italic># I like to use a function defined approach with lambda-apply as it gives me more flexibility and more options. Like if i want to create a column which is 1 if the price is greater than 1200 and 0 otherwise.</span>

<span style=color:#6ab825;font-weight:700>def</span> <span style=color:#447fcf>gt</span>(x):
	<span style=color:#6ab825;font-weight:700>if</span> x&gt;<span style=color:#3677a9>1200</span>:
		<span style=color:#6ab825;font-weight:700>return</span> <span style=color:#3677a9>1</span>
	<span style=color:#6ab825;font-weight:700>else</span>:
		<span style=color:#6ab825;font-weight:700>return</span> <span style=color:#3677a9>0</span>

newDf[<span style=color:#ed9d13>&#39;Pricegt1200&#39;</span>] = newDf.apply(<span style=color:#6ab825;font-weight:700>lambda</span> x: gt(x[<span style=color:#ed9d13>&#39;Price&#39;</span>]),axis=<span style=color:#3677a9>1</span>)
</code></pre></div><h2 id=11-subset-a-dataframe>11. Subset a DataFrame:</h2><div class=highlight><pre style=color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-py data-lang=py><span style=color:#999;font-style:italic># Single condition: dataframe with all entries priced greater than 1500</span>

df_gt_1500 = newDf[newDf[<span style=color:#ed9d13>&#39;Price&#39;</span>]&gt;<span style=color:#3677a9>1500</span>]

<span style=color:#999;font-style:italic># Multiple conditions: AND - dataframe with all entries priced greater than 1500 and from London</span>

And_df = newDf[(newDf[<span style=color:#ed9d13>&#39;Price&#39;</span>]&gt;<span style=color:#3677a9>1500</span>) &amp; (newDf[<span style=color:#ed9d13>&#39;City&#39;</span>]==<span style=color:#ed9d13>&#39;London&#39;</span>)]

<span style=color:#999;font-style:italic># Multiple conditions: OR - dataframe with all entries priced greater than 1500 or from London</span>

Or_df = newDf[(newDf[<span style=color:#ed9d13>&#39;Price&#39;</span>]&gt;<span style=color:#3677a9>1500</span>) | (newDf[<span style=color:#ed9d13>&#39;City&#39;</span>]==<span style=color:#ed9d13>&#39;London&#39;</span>)]

<span style=color:#999;font-style:italic># Multiple conditions: NOT - dataframe with all entries priced greater than 1500 or from London have to be excluded</span>

Not_df = newDf[~((newDf[<span style=color:#ed9d13>&#39;Price&#39;</span>]&gt;<span style=color:#3677a9>1500</span>) | (newDf[<span style=color:#ed9d13>&#39;City&#39;</span>]==<span style=color:#ed9d13>&#39;London&#39;</span>))]
</code></pre></div><h2 id=12-change-the-column-at-particular-places-or-impute>12. Change the Column at particular places or impute:</h2><div class=highlight><pre style=color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-py data-lang=py><span style=color:#999;font-style:italic># In the state column the state is abbreviated as &#39;TX&#39;. We want the whole name &#39;Texas&#39; in there</span>
newDf.loc[newDf[<span style=color:#ed9d13>&#39;State&#39;</span>]==<span style=color:#ed9d13>&#39;TX&#39;</span>,<span style=color:#ed9d13>&#39;State&#39;</span>] = <span style=color:#ed9d13>&#39;Texas&#39;</span>

<span style=color:#999;font-style:italic># When City is Monaco State is not given. You want to impute &#39;Monaco State&#39; as state also.</span>
newDf.loc[newDf[<span style=color:#ed9d13>&#39;City&#39;</span>]==<span style=color:#ed9d13>&#39;Monaco&#39;</span>,<span style=color:#ed9d13>&#39;State&#39;</span>] = <span style=color:#ed9d13>&#39;Monaco State&#39;</span>
</code></pre></div><h2 id=13-groupby>13. GroupBy:</h2><p>One of the most used functionality. One simple example</p><div class=highlight><pre style=color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-py data-lang=py><span style=color:#999;font-style:italic># Find out the sum of transactions by a state. reset_index() is a function that resets the index of a dataframe. I apply this function ALWAYS whenever I do a groupby and you might think of it as a default syntax for groupby operations</span>
<span style=color:#6ab825;font-weight:700>import</span> <span style=color:#447fcf;text-decoration:underline>numpy</span> <span style=color:#6ab825;font-weight:700>as</span> <span style=color:#447fcf;text-decoration:underline>np</span>
newDf.groupby([<span style=color:#ed9d13>&#39;State&#39;</span>]).aggregate(np.sum).reset_index()

<span style=color:#999;font-style:italic># You might get a few extra columns that you dont need. Just subset the columns in the dataframe. You could just chain the commands to subset for the columns you need.</span>
newDf.groupby([<span style=color:#ed9d13>&#39;State&#39;</span>]).aggregate(np.sum).reset_index()[[<span style=color:#ed9d13>&#39;State&#39;</span>,<span style=color:#ed9d13>&#39;Price&#39;</span>]]

<span style=color:#999;font-style:italic># Find minimum transaction in each state</span>
newDf.groupby([<span style=color:#ed9d13>&#39;State&#39;</span>]).aggregate(np.min).reset_index()[[<span style=color:#ed9d13>&#39;State&#39;</span>,<span style=color:#ed9d13>&#39;Price&#39;</span>]]

<span style=color:#999;font-style:italic># You might want to groupby more than one column</span>

newDf.groupby([<span style=color:#ed9d13>&#39;State&#39;</span>,<span style=color:#ed9d13>&#39;City&#39;</span>]).aggregate(np.sum).reset_index()[[<span style=color:#ed9d13>&#39;State&#39;</span>,<span style=color:#ed9d13>&#39;City&#39;</span>,<span style=color:#ed9d13>&#39;Price&#39;</span>]]
</code></pre></div><h2 id=14-concat>14. Concat:</h2><p>You have two datarames df1 and df2 you need to concat. Means append one below the other you can do it using:</p><div class=highlight><pre style=color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-py data-lang=py>pd.concat([df1,df2])
</code></pre></div><h2 id=15-merge>15. Merge:</h2><div class=highlight><pre style=color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-py data-lang=py><span style=color:#999;font-style:italic>#Suppose in the start, you had two dataframes. One which contains city and price information:</span>
City_Price = newwDf[[<span style=color:#ed9d13>&#39;City&#39;</span>,<span style=color:#ed9d13>&#39;Price&#39;</span>]]

<span style=color:#999;font-style:italic>#And another which contains &#39;City&#39; and &#39;State&#39; insformation</span>
City_State = newDf[[<span style=color:#ed9d13>&#39;City&#39;</span>,<span style=color:#ed9d13>&#39;State&#39;</span>]].drop_duplicates(keep=False).reset_index()

<span style=color:#999;font-style:italic>#You need to merge these datatframes on basis of city. You need to do:</span>
City_Price_State_df = pd.merge(City_Price,City_State,on=[<span style=color:#ed9d13>&#39;City&#39;</span>],how=<span style=color:#ed9d13>&#39;left&#39;</span>)
</code></pre></div><h2 id=16-save-a-dataframe-to-external-file>16. Save a Dataframe to external File:</h2><div class=highlight><pre style=color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-py data-lang=py><span style=color:#999;font-style:italic># To Csv file</span>
newDf.to_csv(<span style=color:#ed9d13>&#34;NewDfData.csv&#34;</span>,index=False)

<span style=color:#999;font-style:italic># To Excel File</span>
<span style=color:#6ab825;font-weight:700>from</span> <span style=color:#447fcf;text-decoration:underline>pandas</span> <span style=color:#6ab825;font-weight:700>import</span> ExcelWriter
writer =  ExcelWriter(<span style=color:#ed9d13>&#39;NewDfData.xlsx&#39;</span>)
newDf.to_excel(writer,<span style=color:#ed9d13>&#39;Sheet1&#39;</span>)
writer.save()
</code></pre></div><h2 id=17-pushing-pandas-df-to-a-sql-database>17. Pushing Pandas Df to a sql database:</h2><div class=highlight><pre style=color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-py data-lang=py><span style=color:#6ab825;font-weight:700>from</span> <span style=color:#447fcf;text-decoration:underline>pandas.io</span> <span style=color:#6ab825;font-weight:700>import</span> sql
<span style=color:#6ab825;font-weight:700>import</span> <span style=color:#447fcf;text-decoration:underline>MySQLdb</span>

db = MySQLdb.connect(host=<span style=color:#ed9d13>&#34;localhost&#34;</span>,    <span style=color:#999;font-style:italic># your host, usually localhost</span>
                     user=<span style=color:#ed9d13>&#34;root&#34;</span>,         <span style=color:#999;font-style:italic># your username</span>
                     passwd=<span style=color:#ed9d13>&#34;password&#34;</span>,  <span style=color:#999;font-style:italic># your password</span>
                     db=<span style=color:#ed9d13>&#34;dbname&#34;</span>)        <span style=color:#999;font-style:italic># name of the data base</span>

newDf.to_sql(con = db, name=<span style=color:#ed9d13>&#39;tablename&#39;</span>,if_exists=<span style=color:#ed9d13>&#39;append&#39;</span>,flavor=<span style=color:#ed9d13>&#39;mysql&#39;</span>, chunksize=<span style=color:#3677a9>10000</span>,index=False)
</code></pre></div><p>Hope you found this post useful and worth your time. I tried to make this as simple as possible but You may always <strong>ask me</strong> or see the documentation for doubts.</p><p>If you have <strong>any more ideas</strong> on how to use Pandas or <strong>other usecases</strong>, please suggest in the <strong>comments</strong> section.</p><p>Till then ciao!!</p><h2 id=references>References</h2><ol><li><a href=http://www.gregreda.com/2013/10/26/intro-to-pandas-data-structures/ target=_blank rel="nofollow noopener">Intro to Pandas By Greg Rada</a>
What I have written is in a condensed form, If you want to get a detailed description visit Greg Rada&rsquo;s 3 posts series.</li><li><a href=http://pandas.pydata.org/pandas-docs/stable/ target=_blank rel="nofollow noopener">Pandas Documentation</a></li></ol><script async data-uid=8d7942551b src=https://mlwhiz.ck.page/8d7942551b/index.js></script><div class=shareaholic-canvas data-app=share_buttons data-app-id=28372088 style=margin-bottom:1px></div><a href=https://coursera.pxf.io/coursera rel=nofollow><img border=0 alt="Start your future with a Data Analysis Certificate." src="https://ad.linksynergy.com/fs-bin/show?id=lVarvwc5BD0&bids=759505.377&subid=0&type=4&gridnum=16"></a><div id=disqus_thread></div><script type=application/javascript>var disqus_config=function(){};(function(){if(["localhost","127.0.0.1"].indexOf(window.location.hostname)!=-1){document.getElementById('disqus_thread').innerHTML='Disqus comments not available by default when the website is previewed locally.';return}var b=document,a=b.createElement('script');a.async=!0,a.src='//mlwhiz.disqus.com/embed.js',a.setAttribute('data-timestamp',+new Date),(b.head||b.body).appendChild(a)})()</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><a href=https://disqus.com class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a></div></div><div class=col-lg-4><div class=widget><script type=text/javascript src=https://ko-fi.com/widgets/widget_2.js></script><script type=text/javascript>kofiwidget2.init('Support Me on Ko-fi','#972EB4','S6S3NPCD'),kofiwidget2.draw()</script></div><div class=widget><h4 class=widget-title>About Me</h4><img src=https://mlwhiz.com/images/author.jpg alt class="img-fluid author-thumb-sm d-block mx-auto rounded-circle mb-4"><p>I’m a Machine Learning Engineer based in London, where I am currently working with Roku .</p><a href=https://mlwhiz.com/about/ class="btn btn-outline-primary">Know More</a></div><div class=widget><h4 class=widget-title>Topics</h4><ul class=list-unstyled><li><a class="categoryStyle text-white" href=/categories/awesome-guides>Awesome Guides</a></li><li><a class="categoryStyle text-white" href=/categories/bash>Bash</a></li><li><a class="categoryStyle text-white" href=/categories/big-data>Big Data</a></li><li><a class="categoryStyle text-white" href=/categories/chatgpt-series>Chatgpt Series</a></li><li><a class="categoryStyle text-white" href=/categories/computer-vision>Computer Vision</a></li><li><a class="categoryStyle text-white" href=/categories/data-science>Data Science</a></li><li><a class="categoryStyle text-white" href=/categories/deep-learning>Deep Learning</a></li><li><a class="categoryStyle text-white" href=/categories/learning-resources>Learning Resources</a></li><li><a class="categoryStyle text-white" href=/categories/machine-learning>Machine Learning</a></li><li><a class="categoryStyle text-white" href=/categories/natural-language-processing>Natural Language Processing</a></li><li><a class="categoryStyle text-white" href=/categories/opinion>Opinion</a></li><li><a class="categoryStyle text-white" href=/categories/programming>Programming</a></li></ul></div><div class=widget><h4 class=widget-title>Tags</h4><ul class=list-inline><li class=list-inline-item><a class="tagStyle text-white" href=/tags/algorithms>Algorithms</a></li><li class=list-inline-item><a class="tagStyle text-white" href=/tags/artificial-intelligence>Artificial Intelligence</a></li><li class=list-inline-item><a class="tagStyle text-white" href=/tags/chatgpt>Chatgpt</a></li><li class=list-inline-item><a class="tagStyle text-white" href=/tags/dask>Dask</a></li><li class=list-inline-item><a class="tagStyle text-white" href=/tags/deployment>Deployment</a></li><li class=list-inline-item><a class="tagStyle text-white" href=/tags/ec2>Ec2</a></li><li class=list-inline-item><a class="tagStyle text-white" href=/tags/generative-adversarial-networks>Generative Adversarial Networks</a></li><li class=list-inline-item><a class="tagStyle text-white" href=/tags/graphs>Graphs</a></li><li class=list-inline-item><a class="tagStyle text-white" href=/tags/image-classification>Image Classification</a></li><li class=list-inline-item><a class="tagStyle text-white" href=/tags/instance-segmentation>Instance Segmentation</a></li><li class=list-inline-item><a class="tagStyle text-white" href=/tags/interpretability>Interpretability</a></li><li class=list-inline-item><a class="tagStyle text-white" href=/tags/jobs>Jobs</a></li><li class=list-inline-item><a class="tagStyle text-white" href=/tags/kaggle>Kaggle</a></li><li class=list-inline-item><a class="tagStyle text-white" href=/tags/language-modeling>Language Modeling</a></li><li class=list-inline-item><a class="tagStyle text-white" href=/tags/machine-learning>Machine Learning</a></li><li class=list-inline-item><a class="tagStyle text-white" href=/tags/math>Math</a></li><li class=list-inline-item><a class="tagStyle text-white" href=/tags/multiprocessing>Multiprocessing</a></li><li class=list-inline-item><a class="tagStyle text-white" href=/tags/object-detection>Object Detection</a></li><li class=list-inline-item><a class="tagStyle text-white" href=/tags/oop>Oop</a></li><li class=list-inline-item><a class="tagStyle text-white" href=/tags/opinion>Opinion</a></li><li class=list-inline-item><a class="tagStyle text-white" href=/tags/pandas>Pandas</a></li><li class=list-inline-item><a class="tagStyle text-white" href=/tags/production>Production</a></li><li class=list-inline-item><a class="tagStyle text-white" href=/tags/productivity>Productivity</a></li><li class=list-inline-item><a class="tagStyle text-white" href=/tags/python>Python</a></li><li class=list-inline-item><a class="tagStyle text-white" href=/tags/pytorch>Pytorch</a></li><li class=list-inline-item><a class="tagStyle text-white" href=/tags/spark>Spark</a></li><li class=list-inline-item><a class="tagStyle text-white" href=/tags/sql>SQL</a></li><li class=list-inline-item><a class="tagStyle text-white" href=/tags/statistics>Statistics</a></li><li class=list-inline-item><a class="tagStyle text-white" href=/tags/streamlit>Streamlit</a></li><li class=list-inline-item><a class="tagStyle text-white" href=/tags/text-classification>Text Classification</a></li><li class=list-inline-item><a class="tagStyle text-white" href=/tags/timeseries>Timeseries</a></li><li class=list-inline-item><a class="tagStyle text-white" href=/tags/tools>Tools</a></li><li class=list-inline-item><a class="tagStyle text-white" href=/tags/transformers>Transformers</a></li><li class=list-inline-item><a class="tagStyle text-white" href=/tags/translation>Translation</a></li><li class=list-inline-item><a class="tagStyle text-white" href=/tags/visualization>Visualization</a></li><li class=list-inline-item><a class="tagStyle text-white" href=/tags/xgboost>Xgboost</a></li></ul></div><div class=widget><h4 class=widget-title>Connect With Me</h4><ul class="list-inline social-links"><li class=list-inline-item><a href="https://linkedin.com/comm/mynetwork/discovery-see-all?usecase=PEOPLE_FOLLOWS&followMember=rahulagwl"><i class=ti-linkedin></i></a></li><li class=list-inline-item><a href=https://mlwhiz.medium.com/><i class=ti-book></i></a></li><li class=list-inline-item><a href=https://twitter.com/MLWhiz><i class=ti-twitter-alt></i></a></li><li class=list-inline-item><a href=https://www.facebook.com/mlwhizblog><i class=ti-facebook></i></a></li><li class=list-inline-item><a href=https://github.com/MLWhiz><i class=ti-github></i></a></li></ul></div><script async data-uid=bfe9f82f10 src=https://mlwhiz.ck.page/bfe9f82f10/index.js></script><script async data-uid=3452d924e2 src=https://mlwhiz.ck.page/3452d924e2/index.js></script></div></div></div></section><footer><div class=container><div class=row><div class="col-12 text-center mb-5"><a href=https://mlwhiz.com/><img src=https://mlwhiz.com/images/logos/mlwhiz_black.png class=img-fluid-custom-bottom alt="MLWhiz - Your Home for DS, ML, AI!"></a></div><div class="col-12 border-top py-4 text-center">Copyright © 2020 <a href=https://mlwhiz.com style=color:#972eb4>MLWhiz</a> All Rights Reserved</div></div></div></footer><script>var indexURL="https://mlwhiz.com/index.json"</script><script src=https://mlwhiz.com/plugins/compressjscss/main.js></script><script src=https://mlwhiz.com/js/script.min.js></script><script>(function(a,e,f,g,b,c,d){a.GoogleAnalyticsObject=b,a[b]=a[b]||function(){(a[b].q=a[b].q||[]).push(arguments)},a[b].l=1*new Date,c=e.createElement(f),d=e.getElementsByTagName(f)[0],c.async=1,c.src=g,d.parentNode.insertBefore(c,d)})(window,document,'script','//www.google-analytics.com/analytics.js','ga'),ga('create','UA-54777926-1','auto'),ga('send','pageview')</script></body></html>