<!doctype html><html lang=en-us><head><script async src="https://www.googletagmanager.com/gtag/js?id=G-F34XSWQ5N4"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag('js',new Date),gtag('config','G-F34XSWQ5N4')</script><meta charset=utf-8><title>4 Graph Algorithms on Steroids for data Scientists with cuGraph - MLWhiz</title><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1"><meta name=description content="This post is about automating hyperparameter tuning because our time is more important than the machine."><meta name=author content="Rahul Agarwal"><meta name=generator content="Hugo 0.82.0"><link rel=stylesheet href=https://mlwhiz.com/plugins/compressjscss/main.css><meta property="og:title" content="4 Graph Algorithms on Steroids for data Scientists with cuGraph - MLWhiz"><meta property="og:description" content="This post is about automating hyperparameter tuning because our time is more important than the machine."><meta property="og:type" content="article"><meta property="og:url" content="https://mlwhiz.com/blog/2019/10/20/cugraph/"><meta property="og:image" content="https://mlwhiz.com/images/cugraph/1.jpg"><meta property="og:image:secure_url" content="https://mlwhiz.com/images/cugraph/1.jpg"><meta property="article:published_time" content="2019-11-06T00:00:00+00:00"><meta property="article:modified_time" content="2023-07-07T16:44:48+01:00"><meta property="article:tag" content="Data Science"><meta name=twitter:card content="summary"><meta name=twitter:image content="https://mlwhiz.com/images/cugraph/1.jpg"><meta name=twitter:title content="4 Graph Algorithms on Steroids for data Scientists with cuGraph - MLWhiz"><meta name=twitter:description content="This post is about automating hyperparameter tuning because our time is more important than the machine."><meta name=twitter:site content="@mlwhiz"><meta name=twitter:creator content="@mlwhiz"><link rel=dns-prefetch href=//fonts.googleapis.com><link rel=dns-prefetch href=//fonts.gstatic.com><link rel=stylesheet href=https://mlwhiz.com/scss/style.min.css media=screen><link rel=stylesheet href=/css/style.css><link rel=stylesheet type=text/css href=/css/font/flaticon.css><link rel="shortcut icon" href=https://mlwhiz.com/images/favicon-200x200.png type=image/x-icon><link rel=icon href=https://mlwhiz.com/images/favicon.png type=image/x-icon><link rel=canonical href=https://mlwhiz.com/blog/2019/10/20/cugraph/><script src=https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js></script><script type=application/ld+json>{"@context":"https://schema.org","@graph":[{"@type":"WebSite","@id":"https://www.mlwhiz.com/#website","url":"https://www.mlwhiz.com/","name":"MLWhiz","description":"Want to Learn Computer Vision and NLP? - MLWhiz","potentialAction":{"@type":"SearchAction","target":"https://www.mlwhiz.com/search?s={search_term_string}","query-input":"required name=search_term_string"}},{"@type":"ImageObject","@id":"https://mlwhiz.com/blog/2019/10/20/cugraph/#primaryimage","url":"https://mlwhiz.com/images/cugraph/1.jpg","width":700,"height":450},{"@type":"WebPage","@id":"https://mlwhiz.com/blog/2019/10/20/cugraph/#webpage","url":"https://mlwhiz.com/blog/2019/10/20/cugraph/","inLanguage":"en-US","name":"4 Graph Algorithms on Steroids for data Scientists with cuGraph - MLWhiz","isPartOf":{"@id":"https://www.mlwhiz.com/#website"},"primaryImageOfPage":{"@id":"https://mlwhiz.com/blog/2019/10/20/cugraph/#primaryimage"},"datePublished":"2019-11-06T00:00:00.00Z","dateModified":"2023-07-07T16:44:48.00Z","author":{"@id":"https://mlwhiz.com/about/#/schema/person/76376876bchxkzbchjsdjcca"},"description":"This post is about automating hyperparameter tuning because our time is more important than the machine."},{"@type":["Person"],"@id":"https://mlwhiz.com/about/#/schema/person/76376876bchxkzbchjsdjcca","name":"Rahul Agarwal","image":{"@type":"ImageObject","@id":"https://www.mlwhiz.com/#authorlogo","url":"https://mlwhiz.com/images/author.jpg","caption":"Rahul Agarwal"},"description":"Hi there, I\u2019m Rahul Agarwal. I\u2019m a data scientist consultant and big data engineer based in Bangalore. I see a lot of times  students and even professionals wasting their time and struggling to get started with Computer Vision, Deep Learning, and NLP. I Started this Site with a purpose to augment my own understanding about new things while helping others learn about them in the best possible way.","sameAs":["https://www.linkedin.com/in/rahulagwl/","https://medium.com/@rahul_agarwal","https://twitter.com/MLWhiz","https://www.facebook.com/mlwhizblog","https://github.com/MLWhiz","https://www.instagram.com/itsmlwhiz"]}]}</script><script async data-uid=a0ebaf958d src=https://mlwhiz.ck.page/a0ebaf958d/index.js></script><script type=text/javascript async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML">MathJax.Hub.Config({tex2jax:{inlineMath:[['$','$'],['\\(','\\)']],displayMath:[['$$','$$']],processEscapes:!0,processEnvironments:!0,skipTags:['script','noscript','style','textarea','pre'],TeX:{equationNumbers:{autoNumber:"AMS"},extensions:["AMSmath.js","AMSsymbols.js"]}}}),MathJax.Hub.Queue(function(){var b=MathJax.Hub.getAllJax(),a;for(a=0;a<b.length;a+=1)b[a].SourceElement().parentNode.className+=' has-jax'}),MathJax.Hub.Config({TeX:{equationNumbers:{autoNumber:"AMS"}}})</script><link href=//apps.shareaholic.com/assets/pub/shareaholic.js as=script><script type=text/javascript data-cfasync=false async src=//apps.shareaholic.com/assets/pub/shareaholic.js data-shr-siteid=fd1ffa7fd7152e4e20568fbe49a489d0></script><script>!function(b,e,f,g,a,c,d){if(b.fbq)return;a=b.fbq=function(){a.callMethod?a.callMethod.apply(a,arguments):a.queue.push(arguments)},b._fbq||(b._fbq=a),a.push=a,a.loaded=!0,a.version='2.0',a.queue=[],c=e.createElement(f),c.async=!0,c.src=g,d=e.getElementsByTagName(f)[0],d.parentNode.insertBefore(c,d)}(window,document,'script','https://connect.facebook.net/en_US/fbevents.js'),fbq('init','402633927768628'),fbq('track','PageView')</script><noscript><img height=1 width=1 style=display:none src="https://www.facebook.com/tr?id=402633927768628&ev=PageView&noscript=1"></noscript><meta property="fb:pages" content="213104036293742"><meta name=facebook-domain-verification content="qciidcy7mm137sewruizlvh8zbfnv4"></head><body><noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-NMQD44T" height=0 width=0 style=display:none;visibility:hidden></iframe></noscript><div class=preloader></div><header class=navigation><div class=container><nav class="navbar navbar-expand-lg navbar-white bg-transparent border-bottom pl-0"><a class="navbar-brand mobile-view" href=https://mlwhiz.com/><img class=img-fluid src=https://mlwhiz.com/images/logo.png alt="Helping You Learn Data Science!"></a>
<button class="navbar-toggler border-0" type=button data-toggle=collapse data-target=#navigation>
<i class="ti-menu h3"></i></button><div class="collapse navbar-collapse text-center" id=navigation><div class=desktop-view><ul class="navbar-nav mr-auto"><li class=nav-item><a class=nav-link href=https://www.linkedin.com/in/rahulagwl/><i class=ti-linkedin></i></a></li><li class=nav-item><a class=nav-link href=https://mlwhiz.medium.com/><i class=ti-book></i></a></li><li class=nav-item><a class=nav-link href=https://twitter.com/MLWhiz><i class=ti-twitter-alt></i></a></li><li class=nav-item><a class=nav-link href=https://www.facebook.com/mlwhizblog><i class=ti-facebook></i></a></li><li class=nav-item><a class=nav-link href=https://github.com/MLWhiz><i class=ti-github></i></a></li></ul></div><a class="navbar-brand mx-auto desktop-view" href=https://mlwhiz.com/><img class=img-fluid-custom src=https://mlwhiz.com/images/logo.png alt="Helping You Learn Data Science!"></a><ul class=navbar-nav><li class=nav-item><a class=nav-link href=https://mlwhiz.com/about>About</a></li><li class=nav-item><a class=nav-link href=https://mlwhiz.com/blog>Blog</a></li><li class="nav-item dropdown"><a class="nav-link dropdown-toggle" href=# role=button data-toggle=dropdown aria-haspopup=true aria-expanded=false>Topics</a><div class=dropdown-menu><a class=dropdown-item href=https://mlwhiz.com/categories/natural-language-processing>NLP</a>
<a class=dropdown-item href=https://mlwhiz.com/categories/computer-vision>Computer Vision</a>
<a class=dropdown-item href=https://mlwhiz.com/categories/deep-learning>Deep Learning</a>
<a class=dropdown-item href=https://mlwhiz.com/categories/data-science>DS/ML</a>
<a class=dropdown-item href=https://mlwhiz.com/categories/big-data>Big Data</a>
<a class=dropdown-item href=https://mlwhiz.com/categories/awesome-guides>My Best Content</a>
<a class=dropdown-item href=https://mlwhiz.com/categories/learning-resources>Learning Resources</a></div></li></ul><div class="search pl-lg-4"><button id=searchOpen class=search-btn><i class=ti-search></i></button><div class=search-wrapper><form action=https://mlwhiz.com//search class=h-100><input class="search-box px-4" id=search-query name=s type=search placeholder="Type & Hit Enter..."></form><button id=searchClose class=search-close><i class="ti-close text-dark"></i></button></div></div></div></nav></div></header><section class=section-sm><div class=container><div class=row><div class="col-lg-8 mb-5 mb-lg-0"><a href=/categories/data-science class=categoryStyle>Data Science</a><h1>4 Graph Algorithms on Steroids for data Scientists with cuGraph</h1><div class="mb-3 post-meta"><span>By Rahul Agarwal</span><svg class="meta__icon icon icon-time" width="16" height="14" viewBox="0 0 30 28"><path d="M15 0C7 0 1 6 1 14s6 14 14 14 14-6 14-14S23 0 15 0zm0 25C9 25 4 20 4 14S9 3 15 3s11 5 11 11-5 11-11 11zm1-18h-2v8.4l6.8 4.4L22 18l-6-3.8V7z"/></svg>
<span>06 November 2019</span></div><img src=https://mlwhiz.com/images/cugraph/1.jpg class="img-fluid w-100 mb-4" alt="4 Graph Algorithms on Steroids for data Scientists with cuGraph"><div class="content mb-5"><p>We, as data scientists have gotten quite comfortable with Pandas or SQL or any other relational database.</p><p>We are used to seeing our users in rows with their attributes as columns. But does the real world behave like that?</p><p>In a connected world, users cannot be considered as independent entities. They have got certain relationships with each other, and we would sometimes like to include such relationships while building our machine learning models.</p><p>Now while in a relational database, we cannot use such relations between different rows(users), in a graph database, it is relatively trivial to do that.</p><p>Now, as we know, Python has a great package called Networkx to do this. But the problem with that is that it is not scalable.</p><p><em><strong>A GPU can help solve our scalability problems with its many cores and parallelization. And that is where RAPIDS.ai CuGraph comes in.</strong></em></p><blockquote><p>The
<a href=https://rapids.ai/ target=_blank rel="nofollow noopener">RAPIDS</a>
cuGraph library is a collection of graph analytics that process data found in GPU Dataframes — see
<a href=https://github.com/rapidsai/cudf target=_blank rel="nofollow noopener">cuDF</a>
. cuGraph aims to provide a NetworkX-like API that will be familiar to data scientists, so they can now build GPU-accelerated workflows more easily.</p></blockquote><p><em><strong>In this post, I am going to be talking about some of the most essential graph algorithms you should know and how to implement them using Python with cuGraph.</strong></em></p><hr><h2 id=installation>Installation</h2><p>To install cuGraph you can just use the simple command that you can choose from
<a href=https://rapids.ai/start.html target=_blank rel="nofollow noopener">rapids.ai</a>
based on your system and configuration.</p><p><img sizes="(min-width: 35em) 1200px, 100vw" srcset="/images/cugraph/2_hu482c9ad4d617d383a1353371eb2577da_130031_500x0_resize_box_2.png 500w
, /images/cugraph/2_hu482c9ad4d617d383a1353371eb2577da_130031_800x0_resize_box_2.png 800w
, /images/cugraph/2_hu482c9ad4d617d383a1353371eb2577da_130031_1200x0_resize_box_2.png 1200w
, /images/cugraph/2_hu482c9ad4d617d383a1353371eb2577da_130031_1500x0_resize_box_2.png 1500w" src=/images/cugraph/2.png alt="MLWhiz: Data Science, Machine Learning, Artificial Intelligence"></p><p>The command I used is below and I used a nightly build(recommended):</p><pre><code>conda install -c rapidsai-nightly -c nvidia -c numba -c conda-forge -c anaconda cudf=0.10 cuml=0.10 cugraph=0.10
</code></pre><hr><h2 id=1-connected-components>1. Connected Components</h2><p><img sizes="(min-width: 35em) 1200px, 100vw" srcset="/images/cugraph/3_hu442fee0ac74f1ac542614d39a954a00f_3198245_500x0_resize_q75_box.jpg 500w
, /images/cugraph/3_hu442fee0ac74f1ac542614d39a954a00f_3198245_800x0_resize_q75_box.jpg 800w
, /images/cugraph/3_hu442fee0ac74f1ac542614d39a954a00f_3198245_1200x0_resize_q75_box.jpg 1200w
, /images/cugraph/3_hu442fee0ac74f1ac542614d39a954a00f_3198245_1500x0_resize_q75_box.jpg 1500w" src=/images/cugraph/3.jpg alt="MLWhiz: Data Science, Machine Learning, Artificial Intelligence"></p><p>We all know how clustering works?</p><p><em>You can think of Connected Components in very layman’s terms as a sort of a hard clustering algorithm which finds clusters/islands in related/connected data.</em></p><p><em>As a concrete example:</em> <em><strong>Say you have data about roads joining any two cities in the world. And you need to find out all the continents in the world and which city they contain.</strong></em></p><p>How will you achieve that? Come on, give some thought.</p><p>The connected components algorithm that we use to do this is based on a special case of <strong>BFS/DFS</strong>. I won’t talk much about how it works here, but we will see how to get the code up and running using Networkx as well as cuGraph.</p><h3 id=applications>Applications</h3><p>From a <strong>Retail Perspective</strong>: Let us say, we have a lot of customers using a lot of accounts. One way in which we can use the Connected components algorithm is to find out distinct families in our dataset.</p><p>We can assume edges(roads) between CustomerIDs based on same credit card usage, or same address or same mobile number, etc. Once we have those connections, we can then run the connected component algorithm on the same to create individual clusters to which we can then assign a family ID.</p><p>We can then use these family IDs to provide personalized recommendations based on family needs. We can also use this family ID to fuel our classification algorithms by creating grouped features based on family.</p><p>From a <strong>Finance Perspective</strong>: Another use case would be to capture fraud using these family IDs. If an account has done fraud in the past, it is highly probable that the connected accounts are also susceptible to fraud.</p><p>The possibilities are only limited by your imagination.</p><h3 id=code>Code</h3><p>We will be using the Networkx module in Python for creating and analyzing our graphs.</p><p>Let us start with an example graph which we are using for our purpose. Contains cities and distance information between them.</p><p><img sizes="(min-width: 35em) 1200px, 100vw" srcset="/images/cugraph/3_hu5591e1ae603570fcac65ce7e7d090a54_86748_500x0_resize_box_2.png 500w
, /images/cugraph/3_hu5591e1ae603570fcac65ce7e7d090a54_86748_800x0_resize_box_2.png 800w" src=/images/cugraph/3.png alt="MLWhiz: Data Science, Machine Learning, Artificial Intelligence"></p><p>We first start by creating a list of edges along with the distances which we will add as the weight of the edge:</p><div class=highlight><pre style=color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-py data-lang=py>edgelist = [[<span style=color:#ed9d13>&#39;Mannheim&#39;</span>, <span style=color:#ed9d13>&#39;Frankfurt&#39;</span>, <span style=color:#3677a9>85</span>], [<span style=color:#ed9d13>&#39;Mannheim&#39;</span>, <span style=color:#ed9d13>&#39;Karlsruhe&#39;</span>, <span style=color:#3677a9>80</span>], [<span style=color:#ed9d13>&#39;Erfurt&#39;</span>, <span style=color:#ed9d13>&#39;Wurzburg&#39;</span>, <span style=color:#3677a9>186</span>], [<span style=color:#ed9d13>&#39;Munchen&#39;</span>, <span style=color:#ed9d13>&#39;Numberg&#39;</span>, <span style=color:#3677a9>167</span>], [<span style=color:#ed9d13>&#39;Munchen&#39;</span>, <span style=color:#ed9d13>&#39;Augsburg&#39;</span>, <span style=color:#3677a9>84</span>], [<span style=color:#ed9d13>&#39;Munchen&#39;</span>, <span style=color:#ed9d13>&#39;Kassel&#39;</span>, <span style=color:#3677a9>502</span>], [<span style=color:#ed9d13>&#39;Numberg&#39;</span>, <span style=color:#ed9d13>&#39;Stuttgart&#39;</span>, <span style=color:#3677a9>183</span>], [<span style=color:#ed9d13>&#39;Numberg&#39;</span>, <span style=color:#ed9d13>&#39;Wurzburg&#39;</span>, <span style=color:#3677a9>103</span>], [<span style=color:#ed9d13>&#39;Numberg&#39;</span>, <span style=color:#ed9d13>&#39;Munchen&#39;</span>, <span style=color:#3677a9>167</span>], [<span style=color:#ed9d13>&#39;Stuttgart&#39;</span>, <span style=color:#ed9d13>&#39;Numberg&#39;</span>, <span style=color:#3677a9>183</span>], [<span style=color:#ed9d13>&#39;Augsburg&#39;</span>, <span style=color:#ed9d13>&#39;Munchen&#39;</span>, <span style=color:#3677a9>84</span>], [<span style=color:#ed9d13>&#39;Augsburg&#39;</span>, <span style=color:#ed9d13>&#39;Karlsruhe&#39;</span>, <span style=color:#3677a9>250</span>], [<span style=color:#ed9d13>&#39;Kassel&#39;</span>, <span style=color:#ed9d13>&#39;Munchen&#39;</span>, <span style=color:#3677a9>502</span>], [<span style=color:#ed9d13>&#39;Kassel&#39;</span>, <span style=color:#ed9d13>&#39;Frankfurt&#39;</span>, <span style=color:#3677a9>173</span>], [<span style=color:#ed9d13>&#39;Frankfurt&#39;</span>, <span style=color:#ed9d13>&#39;Mannheim&#39;</span>, <span style=color:#3677a9>85</span>], [<span style=color:#ed9d13>&#39;Frankfurt&#39;</span>, <span style=color:#ed9d13>&#39;Wurzburg&#39;</span>, <span style=color:#3677a9>217</span>], [<span style=color:#ed9d13>&#39;Frankfurt&#39;</span>, <span style=color:#ed9d13>&#39;Kassel&#39;</span>, <span style=color:#3677a9>173</span>], [<span style=color:#ed9d13>&#39;Wurzburg&#39;</span>, <span style=color:#ed9d13>&#39;Numberg&#39;</span>, <span style=color:#3677a9>103</span>], [<span style=color:#ed9d13>&#39;Wurzburg&#39;</span>, <span style=color:#ed9d13>&#39;Erfurt&#39;</span>, <span style=color:#3677a9>186</span>], [<span style=color:#ed9d13>&#39;Wurzburg&#39;</span>, <span style=color:#ed9d13>&#39;Frankfurt&#39;</span>, <span style=color:#3677a9>217</span>], [<span style=color:#ed9d13>&#39;Karlsruhe&#39;</span>, <span style=color:#ed9d13>&#39;Mannheim&#39;</span>, <span style=color:#3677a9>80</span>], [<span style=color:#ed9d13>&#39;Karlsruhe&#39;</span>, <span style=color:#ed9d13>&#39;Augsburg&#39;</span>, <span style=color:#3677a9>250</span>],[<span style=color:#ed9d13>&#34;Mumbai&#34;</span>, <span style=color:#ed9d13>&#34;Delhi&#34;</span>,<span style=color:#3677a9>400</span>],[<span style=color:#ed9d13>&#34;Delhi&#34;</span>, <span style=color:#ed9d13>&#34;Kolkata&#34;</span>,<span style=color:#3677a9>500</span>],[<span style=color:#ed9d13>&#34;Kolkata&#34;</span>, <span style=color:#ed9d13>&#34;Bangalore&#34;</span>,<span style=color:#3677a9>600</span>],[<span style=color:#ed9d13>&#34;TX&#34;</span>, <span style=color:#ed9d13>&#34;NY&#34;</span>,<span style=color:#3677a9>1200</span>],[<span style=color:#ed9d13>&#34;ALB&#34;</span>, <span style=color:#ed9d13>&#34;NY&#34;</span>,<span style=color:#3677a9>800</span>]]
</code></pre></div><p>Now <em><strong>we want to find out distinct continents and their cities from this graph.</strong></em></p><p>First, we will need to create a cudf dataframe with edges in it. Right now, I am creating a pandas dataframe and converting it to cudf dataframe, but in a real-life scenario, we will read from a csv file of edges.</p><div class=highlight><pre style=color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-py data-lang=py><span style=color:#6ab825;font-weight:700>import</span> <span style=color:#447fcf;text-decoration:underline>cugraph</span>
<span style=color:#6ab825;font-weight:700>import</span> <span style=color:#447fcf;text-decoration:underline>cudf</span>
<span style=color:#6ab825;font-weight:700>import</span> <span style=color:#447fcf;text-decoration:underline>pandas</span> <span style=color:#6ab825;font-weight:700>as</span> <span style=color:#447fcf;text-decoration:underline>pd</span>

<span style=color:#999;font-style:italic># create a pandas dataframe of edges</span>
pandas_df = pd.DataFrame(edgelist)
pandas_df.columns = [<span style=color:#ed9d13>&#39;src&#39;</span>,<span style=color:#ed9d13>&#39;dst&#39;</span>,<span style=color:#ed9d13>&#39;distance&#39;</span>]

<span style=color:#999;font-style:italic># create a pandas dataframe of reversed edges as we have a undirected graph</span>
rev_pandas_df = pandas_df.copy()
rev_pandas_df.columns = [<span style=color:#ed9d13>&#39;dst&#39;</span>,<span style=color:#ed9d13>&#39;src&#39;</span>,<span style=color:#ed9d13>&#39;distance&#39;</span>]

rev_pandas_df = rev_pandas_df[[<span style=color:#ed9d13>&#39;src&#39;</span>,<span style=color:#ed9d13>&#39;dst&#39;</span>,<span style=color:#ed9d13>&#39;distance&#39;</span>]]

<span style=color:#999;font-style:italic># concat all edges</span>
pandas_df = pd.concat([pandas_df,rev_pandas_df])
</code></pre></div><p>Now our pandas df contains edges in both directions. And our node names in src and dst columns are in str format. Apparently, cuGraph doesn&rsquo;t like that and only works with integer node IDs.</p><div class=highlight><pre style=color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-py data-lang=py><span style=color:#999;font-style:italic># CuGraph works with only integer node IDs</span>
unique_destinations = <span style=color:#24909d>set</span>()
<span style=color:#6ab825;font-weight:700>for</span> [src,dst,dis] <span style=color:#6ab825;font-weight:700>in</span> edgelist:
  unique_destinations.add(src)
  unique_destinations.add(dst)

<span style=color:#999;font-style:italic># create a map of city and a unique id</span>
city_id_dict = {}
<span style=color:#6ab825;font-weight:700>for</span> i, city <span style=color:#6ab825;font-weight:700>in</span> <span style=color:#24909d>enumerate</span>(unique_destinations):
  city_id_dict[city]=i

<span style=color:#999;font-style:italic># create 2 columns that contain the integer IDs for src and dst</span>
pandas_df[<span style=color:#ed9d13>&#39;src_int&#39;</span>] = pandas_df[<span style=color:#ed9d13>&#39;src&#39;</span>].apply(<span style=color:#6ab825;font-weight:700>lambda</span> x : city_id_dict[x])
pandas_df[<span style=color:#ed9d13>&#39;dst_int&#39;</span>] = pandas_df[<span style=color:#ed9d13>&#39;dst&#39;</span>].apply(<span style=color:#6ab825;font-weight:700>lambda</span> x : city_id_dict[x])
</code></pre></div><p>Now comes the main part that we should focus on:</p><div class=highlight><pre style=color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-py data-lang=py>cuda_g = cudf.DataFrame.from_pandas(pandas_df)

<span style=color:#999;font-style:italic># cugraph needs node IDs to be int32 and weights to be float</span>
cuda_g[<span style=color:#ed9d13>&#39;src_int&#39;</span>] = cuda_g[<span style=color:#ed9d13>&#39;src_int&#39;</span>].astype(np.int32)
cuda_g[<span style=color:#ed9d13>&#39;dst_int&#39;</span>] = cuda_g[<span style=color:#ed9d13>&#39;dst_int&#39;</span>].astype(np.int32)
cuda_g[<span style=color:#ed9d13>&#39;distance&#39;</span>] = cuda_g[<span style=color:#ed9d13>&#39;distance&#39;</span>].astype(np.float)

G = cugraph.Graph()
G.add_edge_list(cuda_g[<span style=color:#ed9d13>&#34;src_int&#34;</span>],cuda_g[<span style=color:#ed9d13>&#34;dst_int&#34;</span>] , cuda_g[<span style=color:#ed9d13>&#39;distance&#39;</span>])

cugraph.weakly_connected_components(G)
</code></pre></div><p>The output of the last call is a cudf dataframe.</p><p><img sizes="(min-width: 35em) 1200px, 100vw" srcset src=/images/cugraph/4.png alt="MLWhiz: Data Science, Machine Learning, Artificial Intelligence"></p><p>As we can see, the labels correspond to Connected Components ID.</p><hr><h2 id=2-shortest-path>2. Shortest Path</h2><p><img sizes="(min-width: 35em) 1200px, 100vw" srcset="/images/cugraph/5_hu9d1243b59606224372fe3aff45f6505c_1608275_500x0_resize_q75_box.jpg 500w
, /images/cugraph/5_hu9d1243b59606224372fe3aff45f6505c_1608275_800x0_resize_q75_box.jpg 800w
, /images/cugraph/5_hu9d1243b59606224372fe3aff45f6505c_1608275_1200x0_resize_q75_box.jpg 1200w
, /images/cugraph/5_hu9d1243b59606224372fe3aff45f6505c_1608275_1500x0_resize_q75_box.jpg 1500w" src=/images/cugraph/5.jpg alt="MLWhiz: Data Science, Machine Learning, Artificial Intelligence"></p><p>Continuing with the above example only, we are given a graph with the cities of Germany and the respective distance between them.</p><p><strong>You want to find out how to go from Frankfurt (The starting node) to Munchen by covering the shortest distance</strong>.</p><p>The algorithm that we use for this problem is called <strong>Dijkstra</strong>. In Dijkstra’s own words:</p><blockquote><p>What is the shortest way to travel from
<a href=https://en.wikipedia.org/wiki/Rotterdam target=_blank rel="nofollow noopener">Rotterdam</a>
to
<a href=https://en.wikipedia.org/wiki/Groningen target=_blank rel="nofollow noopener">Groningen</a>
, in general: from given city to given city.
<a href=https://en.wikipedia.org/wiki/Shortest_path_problem target=_blank rel="nofollow noopener">It is the algorithm for the shortest path</a>
, which I designed in about twenty minutes. One morning I was shopping in
<a href=https://en.wikipedia.org/wiki/Amsterdam target=_blank rel="nofollow noopener">Amsterdam</a>
with my young fiancée, and tired, we sat down on the café terrace to drink a cup of coffee and I was just thinking about whether I could do this, and I then designed the algorithm for the shortest path. As I said, it was a twenty-minute invention. In fact, it was published in ’59, three years later. The publication is still readable, it is, in fact, quite nice. One of the reasons that it is so nice was that I designed it without pencil and paper. I learned later that one of the advantages of designing without pencil and paper is that you are almost forced to avoid all avoidable complexities. Eventually that algorithm became, to my great amazement, one of the cornerstones of my fame.
— Edsger Dijkstra, in an interview with Philip L. Frana, Communications of the ACM, 2001
<a href=https://en.wikipedia.org/wiki/Dijkstra%27s_algorithm#cite_note-Dijkstra_Interview-3 target=_blank rel="nofollow noopener">[3]</a></p></blockquote><h3 id=applications-1>Applications</h3><ul><li><p>Variations of the Dijkstra algorithm is used extensively in Google Maps to find the shortest routes.</p></li><li><p>You are in a Walmart Store. You have different Aisles and distance between all the aisles. You want to provide the shortest pathway to the customer from Aisle A to Aisle D.</p></li></ul><p><img sizes="(min-width: 35em) 1200px, 100vw" srcset src=/images/cugraph/6.png alt="MLWhiz: Data Science, Machine Learning, Artificial Intelligence"></p><ul><li>You have seen how LinkedIn shows up 1st-degree connections, 2nd-degree connections. What goes on behind the scenes?</li></ul><h3 id=code-1>Code</h3><p>We already have our Graph as before. We can find the shortest distance from a source node to all nodes in the graph.</p><div class=highlight><pre style=color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-py data-lang=py><span style=color:#999;font-style:italic># get distances from source node 0</span>
distances = cugraph.sssp(G, <span style=color:#3677a9>0</span>)

<span style=color:#999;font-style:italic># filter infinite distances</span>
distances = cugraph.traversal.filter_unreachable(distances)

distances
</code></pre></div><p><img sizes="(min-width: 35em) 1200px, 100vw" srcset="/images/cugraph/7_hu45b36813c56a8ba2d2895a739615aa44_38490_500x0_resize_box_2.png 500w" src=/images/cugraph/7.png alt="MLWhiz: Data Science, Machine Learning, Artificial Intelligence"></p><p>Now if we have to find the path between node 0 and 14 we can use the distances cudf.</p><div class=highlight><pre style=color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-py data-lang=py><span style=color:#999;font-style:italic># Getting the path is as simple as:</span>

path = []

dest = <span style=color:#3677a9>14</span>
<span style=color:#6ab825;font-weight:700>while</span> dest != <span style=color:#3677a9>0</span>:
   dest = distances[distances[<span style=color:#ed9d13>&#39;vertex&#39;</span>] == dest][<span style=color:#ed9d13>&#39;predecessor&#39;</span>].values[<span style=color:#3677a9>0</span>]
   path.append(dest)

<span style=color:#999;font-style:italic># reverse the list and print</span>
<span style=color:#6ab825;font-weight:700>print</span>(path[::-<span style=color:#3677a9>1</span>])
</code></pre></div><pre><code>[0, 11, 9]
</code></pre><hr><h2 id=3-pagerank>3. Pagerank</h2><p><img sizes="(min-width: 35em) 1200px, 100vw" srcset="/images/cugraph/8_hu24bc0cd68600222ad2e88c1d78d4232f_73516_500x0_resize_q75_box.jpg 500w
, /images/cugraph/8_hu24bc0cd68600222ad2e88c1d78d4232f_73516_800x0_resize_q75_box.jpg 800w" src=/images/cugraph/8.jpg alt="MLWhiz: Data Science, Machine Learning, Artificial Intelligence"></p><p>This is the page sorting algorithm that powered google for a long time. It assigns scores to pages based on the number and quality of incoming and outgoing links.</p><h3 id=applications-2>Applications</h3><p>Pagerank can be used anywhere where we want to estimate node importance in any network.</p><ul><li><p>It has been used for finding the most influential papers using citations.</p></li><li><p>Has been used by Google to rank pages</p></li><li><p>It can be used to rank tweets- User and Tweets as nodes. Create Link between user if user A follows user B and Link between user and Tweets if user tweets/retweets a tweet.</p></li><li><p>Recommendation engines</p></li></ul><h3 id=code-2>Code</h3><p>For this exercise, we are going to be using Facebook social network data.</p><div class=highlight><pre style=color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-py data-lang=py><span style=color:#999;font-style:italic># Loading the file as cudf</span>

fb_cudf = cudf.read_csv(<span style=color:#ed9d13>&#34;facebook_combined.txt&#34;</span>, sep=<span style=color:#ed9d13>&#39; &#39;</span>, names=[<span style=color:#ed9d13>&#39;src&#39;</span>, <span style=color:#ed9d13>&#39;dst&#39;</span>],dtype =[<span style=color:#ed9d13>&#39;int32&#39;</span>,<span style=color:#ed9d13>&#39;int32&#39;</span>])

<span style=color:#999;font-style:italic># adding reverse edges also</span>
rev_fb_cudf = fb_cudf[[<span style=color:#ed9d13>&#39;dst&#39;</span>,<span style=color:#ed9d13>&#39;src&#39;</span>]]
rev_fb_cudf.columns = [<span style=color:#ed9d13>&#39;src&#39;</span>,<span style=color:#ed9d13>&#39;dst&#39;</span>]
fb_cudf = cudf.concat([fb_cudf,rev_fb_cudf])
</code></pre></div><p>Creating the graph</p><div class=highlight><pre style=color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-py data-lang=py><span style=color:#999;font-style:italic># creating the graph</span>
fb_G = cugraph.Graph()
fb_G.add_edge_list(fb_cudf[<span style=color:#ed9d13>&#34;src&#34;</span>],fb_cudf[<span style=color:#ed9d13>&#34;dst&#34;</span>])
</code></pre></div><p><img sizes="(min-width: 35em) 1200px, 100vw" srcset="/images/cugraph/9_hu462f793167e721852f85e6a79efd27c7_280218_500x0_resize_box_2.png 500w
, /images/cugraph/9_hu462f793167e721852f85e6a79efd27c7_280218_800x0_resize_box_2.png 800w
, /images/cugraph/9_hu462f793167e721852f85e6a79efd27c7_280218_1200x0_resize_box_2.png 1200w" src=/images/cugraph/9.png alt="MLWhiz: Data Science, Machine Learning, Artificial Intelligence"></p><p>Now we want to find the users having high influence capability.</p><p>Intuitively, the Pagerank algorithm will give a higher score to a user who has a lot of friends who in turn have a lot of FB Friends.</p><div class=highlight><pre style=color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-py data-lang=py><span style=color:#999;font-style:italic># Call cugraph.pagerank to get the pagerank scores</span>
fb_pagerank = cugraph.pagerank(fb_G)
fb_pagerank.sort_values(by=<span style=color:#ed9d13>&#39;pagerank&#39;</span>,ascending=False).head()
</code></pre></div><p><img sizes="(min-width: 35em) 1200px, 100vw" srcset src=/images/cugraph/10.png alt="MLWhiz: Data Science, Machine Learning, Artificial Intelligence"></p><hr><h2 id=4-link-prediction>4. Link Prediction</h2><p><img sizes="(min-width: 35em) 1200px, 100vw" srcset="/images/cugraph/11_hu8c10979a9462e38538f704b8cf047f2c_1626856_500x0_resize_q75_box.jpg 500w
, /images/cugraph/11_hu8c10979a9462e38538f704b8cf047f2c_1626856_800x0_resize_q75_box.jpg 800w
, /images/cugraph/11_hu8c10979a9462e38538f704b8cf047f2c_1626856_1200x0_resize_q75_box.jpg 1200w
, /images/cugraph/11_hu8c10979a9462e38538f704b8cf047f2c_1626856_1500x0_resize_q75_box.jpg 1500w" src=/images/cugraph/11.jpg alt="MLWhiz: Data Science, Machine Learning, Artificial Intelligence"></p><p>Continuing along with our Facebook example. You might have seen recommended friends in your Facebook account. How can we create our small recommender?</p><p><em><strong>Can we predict which edges will be connected in the future based on current edges?</strong></em></p><p>A straightforward and fast approach to do this is by using the Jaccard Coefficient.</p><h3 id=applications-3>Applications</h3><p>There could be many applications of link predictions. We could predict</p><ul><li><p>Authors who are going to connect for co-authorships in a citation network</p></li><li><p>Who will become friends in a social network?</p></li></ul><h3 id=idea>Idea</h3><p>We calculate the Jaccard coefficient between two nodes i and j as :</p><p><img sizes="(min-width: 35em) 1200px, 100vw" srcset src=/images/cugraph/12.png alt="MLWhiz: Data Science, Machine Learning, Artificial Intelligence"></p><p>Where the numerator is the number of common neighbors of i and j, and the denominator is the total number of distinct neighbors of i and j.</p><p><img sizes="(min-width: 35em) 1200px, 100vw" srcset="/images/cugraph/13_hu491cc1f78c98d4b68cc7fbbc8f786d45_86968_500x0_resize_box_2.png 500w
, /images/cugraph/13_hu491cc1f78c98d4b68cc7fbbc8f786d45_86968_800x0_resize_box_2.png 800w
, /images/cugraph/13_hu491cc1f78c98d4b68cc7fbbc8f786d45_86968_1200x0_resize_box_2.png 1200w" src=/images/cugraph/13.png alt="MLWhiz: Data Science, Machine Learning, Artificial Intelligence"></p><p>So in the figure, the half red and green nodes are the common neighbors of both A and B. And they have a total of 5 distinct neighbors. So the JaccardCoeff(A, B) is 2/5</p><h3 id=code-3>Code</h3><p>We first create a cudf_nodes cudf with all possible node combinations.</p><div class=highlight><pre style=color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-py data-lang=py>max_vertex_id = fb_pagerank[<span style=color:#ed9d13>&#39;vertex&#39;</span>].max()
data = []
<span style=color:#6ab825;font-weight:700>for</span> x <span style=color:#6ab825;font-weight:700>in</span> <span style=color:#24909d>range</span>(<span style=color:#3677a9>0</span>,max_vertex_id+<span style=color:#3677a9>1</span>):
  <span style=color:#6ab825;font-weight:700>for</span> y <span style=color:#6ab825;font-weight:700>in</span> <span style=color:#24909d>range</span>(<span style=color:#3677a9>0</span>,max_vertex_id+<span style=color:#3677a9>1</span>):
    data.append([x,y])
cudf_nodes =cudf.from_pandas(pd.DataFrame(data))
cudf_nodes.columns = [<span style=color:#ed9d13>&#39;src&#39;</span>,<span style=color:#ed9d13>&#39;dst&#39;</span>]

cudf_nodes[<span style=color:#ed9d13>&#39;src&#39;</span>] = cudf_nodes[<span style=color:#ed9d13>&#39;src&#39;</span>].astype(np.int32)
cudf_nodes[<span style=color:#ed9d13>&#39;dst&#39;</span>] = cudf_nodes[<span style=color:#ed9d13>&#39;dst&#39;</span>].astype(np.int32)
</code></pre></div><p>We can then calculate the Jaccard coefficient between nodes as:</p><div class=highlight><pre style=color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-py data-lang=py>jaccard_coeff_between_nodes = cugraph.link_prediction.jaccard(fb_G,cudf_nodes[<span style=color:#ed9d13>&#34;src&#34;</span>],cudf_nodes[<span style=color:#ed9d13>&#34;dst&#34;</span>])
jaccard_coeff_between_nodes.head()
</code></pre></div><p><img sizes="(min-width: 35em) 1200px, 100vw" srcset="/images/cugraph/14_hu0f278deb593b0886aa401984b43edec5_27334_500x0_resize_box_2.png 500w" src=/images/cugraph/14.png alt="MLWhiz: Data Science, Machine Learning, Artificial Intelligence"></p><p><em><strong>But we are still not done.</strong></em> We need to remove the edges where the source==destination and the edges which are already present in the graph. We will do this using simple join and filter operations which work particularly similar to pandas.</p><div class=highlight><pre style=color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-py data-lang=py>jaccard_coeff_between_nodes=jaccard_coeff_between_nodes[jaccard_coeff_between_nodes[<span style=color:#ed9d13>&#39;source&#39;</span>]!=jaccard_coeff_between_nodes[<span style=color:#ed9d13>&#39;destination&#39;</span>]]
fb_cudf.columns = [<span style=color:#ed9d13>&#39;source&#39;</span>, <span style=color:#ed9d13>&#39;destination&#39;</span>]
fb_cudf[<span style=color:#ed9d13>&#39;edgeflag&#39;</span>]=<span style=color:#3677a9>1</span>
jaccard_coeff_joined_with_edges = jaccard_coeff_between_nodes.merge(fb_cudf,on= [<span style=color:#ed9d13>&#39;source&#39;</span>, <span style=color:#ed9d13>&#39;destination&#39;</span>],how=<span style=color:#ed9d13>&#39;left&#39;</span>)
<span style=color:#999;font-style:italic># We just want to see the jaccard coeff of new edges</span>
new_edges_jaccard_coeff = jaccard_coeff_joined_with_edges[jaccard_coeff_joined_with_edges[<span style=color:#ed9d13>&#39;edgeflag&#39;</span>]!=<span style=color:#3677a9>1</span>]
</code></pre></div><p>This is our final sorted dataframe with the Jaccard coefficient between unconnected nodes. We know what friends to recommend to our platform users.</p><div class=highlight><pre style=color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-py data-lang=py>new_edges_jaccard_coeff.sort_values(by=<span style=color:#ed9d13>&#39;jaccard_coeff&#39;</span>,ascending=False)
</code></pre></div><p><img sizes="(min-width: 35em) 1200px, 100vw" srcset="/images/cugraph/15_hu78cd02789d63243b6af3cfe0696f9ac6_46794_500x0_resize_box_2.png 500w
, /images/cugraph/15_hu78cd02789d63243b6af3cfe0696f9ac6_46794_800x0_resize_box_2.png 800w" src=/images/cugraph/15.png alt="MLWhiz: Data Science, Machine Learning, Artificial Intelligence"></p><hr><h2 id=basic-network-statistics>Basic Network Statistics</h2><p><img sizes="(min-width: 35em) 1200px, 100vw" srcset="/images/cugraph/16_hu6638b7262f6b1f3f5943b2eae48c5190_2985066_500x0_resize_q75_box.jpg 500w
, /images/cugraph/16_hu6638b7262f6b1f3f5943b2eae48c5190_2985066_800x0_resize_q75_box.jpg 800w
, /images/cugraph/16_hu6638b7262f6b1f3f5943b2eae48c5190_2985066_1200x0_resize_q75_box.jpg 1200w
, /images/cugraph/16_hu6638b7262f6b1f3f5943b2eae48c5190_2985066_1500x0_resize_q75_box.jpg 1500w" src=/images/cugraph/16.jpg alt="MLWhiz: Data Science, Machine Learning, Artificial Intelligence"></p><p>There are a lot of basic measures which you want to know about your network.</p><p>Here is how you get them in your network</p><div class=highlight><pre style=color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-py data-lang=py><span style=color:#6ab825;font-weight:700>print</span>(<span style=color:#ed9d13>&#34;Number of Nodes&#34;</span>,fb_G.number_of_nodes())
<span style=color:#6ab825;font-weight:700>print</span>(<span style=color:#ed9d13>&#34;Number of Edges&#34;</span>,fb_G.number_of_edges())
</code></pre></div><pre><code>Number of Nodes 4039
Number of Edges 176468
</code></pre><p>You can also compute the indegree and outdegree for each node.</p><p>In a directed graph this corresponds to no of followers and no of follows.</p><div class=highlight><pre style=color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-py data-lang=py>fb_G.degrees().head()
</code></pre></div><p><img sizes="(min-width: 35em) 1200px, 100vw" srcset="/images/cugraph/17_hu9f79b2e569bbf1fa61d8951b9c5fa70e_14010_500x0_resize_box_2.png 500w" src=/images/cugraph/17.png alt="MLWhiz: Data Science, Machine Learning, Artificial Intelligence"></p><hr><h2 id=performance-benchmarks>Performance Benchmarks</h2><p>I won’t do any justice to this post if I don’t add certain benchmarks for the different algorithms.</p><p>In my benchmark study, I use three datasets in increasing order of scale from the Stanford Large Network Dataset Collection.</p><ol><li><p><a href=https://snap.stanford.edu/data/ego-Facebook.html target=_blank rel="nofollow noopener">ego-Facebook</a>
: Undirected graph with <em><strong>4 K nodes and 88 K edges</strong></em> from Facebook</p></li><li><p><a href=https://snap.stanford.edu/data/ego-Twitter.html target=_blank rel="nofollow noopener">ego-Twitter</a>
: Directed graph with <em><strong>81 K nodes and 1.7 M</strong></em> edges from Twitter</p></li><li><p><a href=https://snap.stanford.edu/data/ego-Gplus.html target=_blank rel="nofollow noopener">ego-Gplus</a>
: Directed graph with <em><strong>107 K nodes and 13.6 M</strong></em> edges from Google+</p></li></ol><p>Here are the results of the experiments I performed on NVIDIA
<a href=https://amzn.to/2OaF9uq target=_blank rel="nofollow noopener">&lt;em>&lt;strong>Tesla V100 32 GB GPU&lt;/strong>&lt;/em></a>
. Thanks to Josh Patterson from NVIDIA and Richard Ulrich at Walmart Labs for arranging that for me. All the times are given in milliseconds:</p><p><img sizes="(min-width: 35em) 1200px, 100vw" srcset="/images/cugraph/18_hub8e561c3504a01bdcc0cd9357a6deb0e_131681_500x0_resize_box_2.png 500w" src=/images/cugraph/18.png alt="MLWhiz: Data Science, Machine Learning, Artificial Intelligence"></p><p>I didn’t add Jaccard coefficients in the results as it didn’t run even for facebook using networkX. For cuGraph it had millisecond-level latencies.</p><p>Let us visualize these results:</p><p><img sizes="(min-width: 35em) 1200px, 100vw" srcset="/images/cugraph/cc_hu467a614cb6379a8b7c4836b5949ca8ef_59106_500x0_resize_box_2.png 500w
, /images/cugraph/cc_hu467a614cb6379a8b7c4836b5949ca8ef_59106_800x0_resize_box_2.png 800w
, /images/cugraph/cc_hu467a614cb6379a8b7c4836b5949ca8ef_59106_1200x0_resize_box_2.png 1200w
, /images/cugraph/cc_hu467a614cb6379a8b7c4836b5949ca8ef_59106_1500x0_resize_box_2.png 1500w" src=/images/cugraph/cc.png alt="MLWhiz: Data Science, Machine Learning, Artificial Intelligence"></p><p><img sizes="(min-width: 35em) 1200px, 100vw" srcset="/images/cugraph/sp_hufec294e8f8c82b4f5255494aefaae796_64029_500x0_resize_box_2.png 500w
, /images/cugraph/sp_hufec294e8f8c82b4f5255494aefaae796_64029_800x0_resize_box_2.png 800w
, /images/cugraph/sp_hufec294e8f8c82b4f5255494aefaae796_64029_1200x0_resize_box_2.png 1200w
, /images/cugraph/sp_hufec294e8f8c82b4f5255494aefaae796_64029_1500x0_resize_box_2.png 1500w" src=/images/cugraph/sp.png alt="MLWhiz: Data Science, Machine Learning, Artificial Intelligence"></p><p><img sizes="(min-width: 35em) 1200px, 100vw" srcset="/images/cugraph/pr_hue64c3e0bc0ff620dff2dbd8984fbced0_59725_500x0_resize_box_2.png 500w
, /images/cugraph/pr_hue64c3e0bc0ff620dff2dbd8984fbced0_59725_800x0_resize_box_2.png 800w
, /images/cugraph/pr_hue64c3e0bc0ff620dff2dbd8984fbced0_59725_1200x0_resize_box_2.png 1200w
, /images/cugraph/pr_hue64c3e0bc0ff620dff2dbd8984fbced0_59725_1500x0_resize_box_2.png 1500w" src=/images/cugraph/pr.png alt="MLWhiz: Data Science, Machine Learning, Artificial Intelligence"></p><hr><h2 id=caveats>Caveats</h2><p>Rapids cuGraph is an excellent library for graph analysis, but I feel some things are still missing. Maybe we will get them in the next version.</p><ul><li><p>A little bit of inconvenience that we have to use numbered nodes with data type int32 only. Renumbering helps with that. See my notebook for the
<a href=https://github.com/MLWhiz/data_science_blogs/tree/master/cuGraph_Benchmark target=_blank rel="nofollow noopener">benchmark</a>
for the exact code. Check the function cugraph.symmetrize_df too for creating undirected graphs.</p></li><li><p>Some algorithms are still not implemented. For instance, I could not find MST, Centrality measures, etc.</p></li><li><p>More example notebooks are needed to document best practices. I might be going to be work on some of those.</p></li><li><p>No visualization component in the library. I have to go to networkx to plot graphs.</p></li></ul><p><em><strong>But despite that, I would also like to add that the idea to provide graph analysis with GPU is so great that I can live with these small problems.</strong></em> And the way they have made the API so similar to pandas and networkx adds to its value.</p><p><em><strong>I remember how using GPU needed a lot of code in the past. RAPIDS has aimed to make GPU ubiquitous, and that is a fabulous initiative.</strong></em></p><hr><h2 id=conclusion>Conclusion</h2><p><img sizes="(min-width: 35em) 1200px, 100vw" srcset="/images/cugraph/system_hu7bc9aae7b5f72987dd3dd9c3d954426c_1301922_500x0_resize_q75_box.jpg 500w
, /images/cugraph/system_hu7bc9aae7b5f72987dd3dd9c3d954426c_1301922_800x0_resize_q75_box.jpg 800w
, /images/cugraph/system_hu7bc9aae7b5f72987dd3dd9c3d954426c_1301922_1200x0_resize_q75_box.jpg 1200w
, /images/cugraph/system_hu7bc9aae7b5f72987dd3dd9c3d954426c_1301922_1500x0_resize_q75_box.jpg 1500w" src=/images/cugraph/system.jpg alt="MLWhiz: Data Science, Machine Learning, Artificial Intelligence"></p><p><em><strong>In this post, I talked about some of the most powerful graph algorithms that have changed the way we live and how to scale them with GPUs.</strong></em></p><p>I love the way Rapids AI has been working to make GPUs accessible to the typical developer/data scientist and to think that we hadn’t heard about it till a year back. They have come a long way.</p><p>Also, here are the newest version 0.9 documentation for
<a href=https://docs.rapids.ai/api/cudf/stable/ target=_blank rel="nofollow noopener">cuDF</a>
and
<a href=https://docs.rapids.ai/api/cugraph/stable/ target=_blank rel="nofollow noopener">cuGraph</a>
.</p><p>You can get the running code in this
<a href=https://colab.research.google.com/drive/1quS3-yg6frFo__4VyJTyUytHhqnBQ9j_ target=_blank rel="nofollow noopener">Google Colab Notebook</a>
, and the code with benchmarks on my
<a href=https://github.com/MLWhiz/data_science_blogs/tree/master/cuGraph_Benchmark target=_blank rel="nofollow noopener">Github repository</a>
as Google Colab fell short on resources while benchmarking.</p><hr><h2 id=continue-learning>Continue Learning</h2><p>If you want to read up more on Graph Algorithms here is a
<a href=https://coursera.pxf.io/YgKbbe target=_blank rel="nofollow noopener">Graph Analytics for Big Data course on Coursera by UCSanDiego</a>
, which I highly recommend to learn the basics of graph theory.</p><p>Thanks for the read. I am going to be writing more beginner-friendly posts in the future too. Follow me up at
<a href="https://mlwhiz.medium.com/?source=post_page---------------------------" target=_blank rel="nofollow noopener">&lt;strong>Medium&lt;/strong></a>
or Subscribe to my
<a href=https://mlwhiz.ck.page/a9b8bda70c target=_blank rel="nofollow noopener">&lt;strong>blog&lt;/strong></a>
.</p><p>Also, a small disclaimer — There might be some affiliate links in this post to relevant resources as sharing knowledge is never a bad idea.</p><script async data-uid=8d7942551b src=https://mlwhiz.ck.page/8d7942551b/index.js></script><div class=shareaholic-canvas data-app=share_buttons data-app-id=28372088 style=margin-bottom:1px></div><a href=https://coursera.pxf.io/coursera rel=nofollow><img border=0 alt="Start your future with a Data Analysis Certificate." src="https://ad.linksynergy.com/fs-bin/show?id=lVarvwc5BD0&bids=759505.377&subid=0&type=4&gridnum=16"></a><div id=disqus_thread></div><script type=application/javascript>var disqus_config=function(){};(function(){if(["localhost","127.0.0.1"].indexOf(window.location.hostname)!=-1){document.getElementById('disqus_thread').innerHTML='Disqus comments not available by default when the website is previewed locally.';return}var b=document,a=b.createElement('script');a.async=!0,a.src='//mlwhiz.disqus.com/embed.js',a.setAttribute('data-timestamp',+new Date),(b.head||b.body).appendChild(a)})()</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><a href=https://disqus.com class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a></div></div><div class=col-lg-4><div class=widget><script type=text/javascript src=https://ko-fi.com/widgets/widget_2.js></script><script type=text/javascript>kofiwidget2.init('Support Me on Ko-fi','#00aaa1','S6S3NPCD'),kofiwidget2.draw()</script></div><div class=widget><h4 class=widget-title>About Me</h4><img src=https://mlwhiz.com/images/author.jpg alt class="img-fluid author-thumb-sm d-block mx-auto rounded-circle mb-4"><p>I’m a data scientist consultant and big data engineer based in London, where I am currently working with Facebook .</p><a href=https://mlwhiz.com/about/ class="btn btn-outline-primary">Know More</a></div><div class=widget><h4 class=widget-title>Topics</h4><ul class=list-unstyled><li><a class=categoryStyle style=color:#fff href=/categories/awesome-guides>Awesome Guides</a></li><li><a class=categoryStyle style=color:#fff href=/categories/bash>Bash</a></li><li><a class=categoryStyle style=color:#fff href=/categories/big-data>Big Data</a></li><li><a class=categoryStyle style=color:#fff href=/categories/chatgpt-series>Chatgpt Series</a></li><li><a class=categoryStyle style=color:#fff href=/categories/computer-vision>Computer Vision</a></li><li><a class=categoryStyle style=color:#fff href=/categories/data-science>Data Science</a></li><li><a class=categoryStyle style=color:#fff href=/categories/deep-learning>Deep Learning</a></li><li><a class=categoryStyle style=color:#fff href=/categories/learning-resources>Learning Resources</a></li><li><a class=categoryStyle style=color:#fff href=/categories/machine-learning>Machine Learning</a></li><li><a class=categoryStyle style=color:#fff href=/categories/natural-language-processing>Natural Language Processing</a></li><li><a class=categoryStyle style=color:#fff href=/categories/opinion>Opinion</a></li><li><a class=categoryStyle style=color:#fff href=/categories/programming>Programming</a></li></ul></div><div class=widget><h4 class=widget-title>Tags</h4><ul class=list-inline><li class=list-inline-item><a class="tagStyle text-white" href=/tags/algorithms>Algorithms</a></li><li class=list-inline-item><a class="tagStyle text-white" href=/tags/artificial-intelligence>Artificial Intelligence</a></li><li class=list-inline-item><a class="tagStyle text-white" href=/tags/chatgpt>Chatgpt</a></li><li class=list-inline-item><a class="tagStyle text-white" href=/tags/dask>Dask</a></li><li class=list-inline-item><a class="tagStyle text-white" href=/tags/deployment>Deployment</a></li><li class=list-inline-item><a class="tagStyle text-white" href=/tags/ec2>Ec2</a></li><li class=list-inline-item><a class="tagStyle text-white" href=/tags/generative-adversarial-networks>Generative Adversarial Networks</a></li><li class=list-inline-item><a class="tagStyle text-white" href=/tags/graphs>Graphs</a></li><li class=list-inline-item><a class="tagStyle text-white" href=/tags/image-classification>Image Classification</a></li><li class=list-inline-item><a class="tagStyle text-white" href=/tags/instance-segmentation>Instance Segmentation</a></li><li class=list-inline-item><a class="tagStyle text-white" href=/tags/interpretability>Interpretability</a></li><li class=list-inline-item><a class="tagStyle text-white" href=/tags/jobs>Jobs</a></li><li class=list-inline-item><a class="tagStyle text-white" href=/tags/kaggle>Kaggle</a></li><li class=list-inline-item><a class="tagStyle text-white" href=/tags/language-modeling>Language Modeling</a></li><li class=list-inline-item><a class="tagStyle text-white" href=/tags/machine-learning>Machine Learning</a></li><li class=list-inline-item><a class="tagStyle text-white" href=/tags/math>Math</a></li><li class=list-inline-item><a class="tagStyle text-white" href=/tags/multiprocessing>Multiprocessing</a></li><li class=list-inline-item><a class="tagStyle text-white" href=/tags/object-detection>Object Detection</a></li><li class=list-inline-item><a class="tagStyle text-white" href=/tags/oop>Oop</a></li><li class=list-inline-item><a class="tagStyle text-white" href=/tags/opinion>Opinion</a></li><li class=list-inline-item><a class="tagStyle text-white" href=/tags/pandas>Pandas</a></li><li class=list-inline-item><a class="tagStyle text-white" href=/tags/production>Production</a></li><li class=list-inline-item><a class="tagStyle text-white" href=/tags/productivity>Productivity</a></li><li class=list-inline-item><a class="tagStyle text-white" href=/tags/python>Python</a></li><li class=list-inline-item><a class="tagStyle text-white" href=/tags/pytorch>Pytorch</a></li><li class=list-inline-item><a class="tagStyle text-white" href=/tags/spark>Spark</a></li><li class=list-inline-item><a class="tagStyle text-white" href=/tags/sql>SQL</a></li><li class=list-inline-item><a class="tagStyle text-white" href=/tags/statistics>Statistics</a></li><li class=list-inline-item><a class="tagStyle text-white" href=/tags/streamlit>Streamlit</a></li><li class=list-inline-item><a class="tagStyle text-white" href=/tags/text-classification>Text Classification</a></li><li class=list-inline-item><a class="tagStyle text-white" href=/tags/timeseries>Timeseries</a></li><li class=list-inline-item><a class="tagStyle text-white" href=/tags/tools>Tools</a></li><li class=list-inline-item><a class="tagStyle text-white" href=/tags/transformers>Transformers</a></li><li class=list-inline-item><a class="tagStyle text-white" href=/tags/translation>Translation</a></li><li class=list-inline-item><a class="tagStyle text-white" href=/tags/visualization>Visualization</a></li><li class=list-inline-item><a class="tagStyle text-white" href=/tags/xgboost>Xgboost</a></li></ul></div><div class=widget><h4 class=widget-title>Connect With Me</h4><ul class="list-inline social-links"><li class=list-inline-item><a href=https://www.linkedin.com/in/rahulagwl/><i class=ti-linkedin></i></a></li><li class=list-inline-item><a href=https://mlwhiz.medium.com/><i class=ti-book></i></a></li><li class=list-inline-item><a href=https://twitter.com/MLWhiz><i class=ti-twitter-alt></i></a></li><li class=list-inline-item><a href=https://www.facebook.com/mlwhizblog><i class=ti-facebook></i></a></li><li class=list-inline-item><a href=https://github.com/MLWhiz><i class=ti-github></i></a></li></ul></div><script async data-uid=bfe9f82f10 src=https://mlwhiz.ck.page/bfe9f82f10/index.js></script><script async data-uid=3452d924e2 src=https://mlwhiz.ck.page/3452d924e2/index.js></script></div></div></div></section><footer><div class=container><div class=row><div class="col-12 text-center mb-5"><a href=https://mlwhiz.com/><img src=https://mlwhiz.com/images/logo.png class=img-fluid-custom-bottom alt="Helping You Learn Data Science!"></a></div><div class="col-12 border-top py-4 text-center">Copyright © 2020 <a href=https://mlwhiz.com>MLWhiz</a> All Rights Reserved</div></div></div></footer><script>var indexURL="https://mlwhiz.com/index.json"</script><script src=https://mlwhiz.com/plugins/compressjscss/main.js></script><script src=https://mlwhiz.com/js/script.min.js></script><script>(function(a,e,f,g,b,c,d){a.GoogleAnalyticsObject=b,a[b]=a[b]||function(){(a[b].q=a[b].q||[]).push(arguments)},a[b].l=1*new Date,c=e.createElement(f),d=e.getElementsByTagName(f)[0],c.async=1,c.src=g,d.parentNode.insertBefore(c,d)})(window,document,'script','//www.google-analytics.com/analytics.js','ga'),ga('create','UA-54777926-1','auto'),ga('send','pageview')</script></body></html>