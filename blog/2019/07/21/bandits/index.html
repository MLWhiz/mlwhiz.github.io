<!doctype html><html lang=en-us><head><meta charset=utf-8><title>MLWhiz: Helping You Learn Data Science!</title><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1"><meta name=description content="There are multiple ways to doing the same thing in Pandas, and that might make it troublesome for the beginner user.This post is about handling most of the data manipulation cases in Python using a straightforward, simple, and matter of fact way."><meta name=author content="Rahul Agarwal"><meta name=generator content="Hugo 0.74.3"><link rel=stylesheet href=https://mlwhiz.com/plugins/compressjscss/main.css><meta property="og:title" content="Bayesian Bandits explained simply"><meta property="og:description" content="There are multiple ways to doing the same thing in Pandas, and that might make it troublesome for the beginner user.This post is about handling most of the data manipulation cases in Python using a straightforward, simple, and matter of fact way."><meta property="og:type" content="article"><meta property="og:url" content="https://mlwhiz.com/blog/2019/07/21/bandits/"><meta property="og:image" content="https://mlwhiz.com/images/bandits/1.png"><meta property="og:image:secure_url" content="https://mlwhiz.com/images/bandits/1.png"><meta property="article:published_time" content="2019-07-21T00:00:00+00:00"><meta property="article:modified_time" content="2020-09-26T16:23:35+05:30"><meta property="article:tag" content="Data Science"><meta name=twitter:card content="summary"><meta name=twitter:image content="https://mlwhiz.com/images/bandits/1.png"><meta name=twitter:title content="Bayesian Bandits explained simply"><meta name=twitter:description content="There are multiple ways to doing the same thing in Pandas, and that might make it troublesome for the beginner user.This post is about handling most of the data manipulation cases in Python using a straightforward, simple, and matter of fact way."><meta name=twitter:site content="@mlwhiz"><meta name=twitter:creator content="@mlwhiz"><link rel=dns-prefetch href=//fonts.googleapis.com><link rel=dns-prefetch href=//fonts.gstatic.com><link rel=stylesheet href=https://mlwhiz.com/scss/style.min.css media=screen><link rel=stylesheet href=/css/style.css><link rel=stylesheet type=text/css href=/css/font/flaticon.css><link rel="shortcut icon" href=https://mlwhiz.com/images/favicon-200x200.png type=image/x-icon><link rel=icon href=https://mlwhiz.com/images/favicon.png type=image/x-icon><link rel=canonical href=https://mlwhiz.com/blog/2019/07/21/bandits/><script src=https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js></script><script type=application/ld+json>{"@context":"https://schema.org","@graph":[{"@type":"WebSite","@id":"https://www.mlwhiz.com/#website","url":"https://www.mlwhiz.com/","name":"MLWhiz","description":"Want to Learn Computer Vision and NLP? - MLWhiz","potentialAction":{"@type":"SearchAction","target":"https://www.mlwhiz.com/search?s={search_term_string}","query-input":"required name=search_term_string"}},{"@type":"ImageObject","@id":"https://mlwhiz.com/blog/2019/07/21/bandits/#primaryimage","url":"https://mlwhiz.com/images/bandits/1.png","width":700,"height":450},{"@type":"WebPage","@id":"https://mlwhiz.com/blog/2019/07/21/bandits/#webpage","url":"https://mlwhiz.com/blog/2019/07/21/bandits/","inLanguage":"en-US","name":"Bayesian Bandits explained simply - MLWhiz","isPartOf":{"@id":"https://www.mlwhiz.com/#website"},"primaryImageOfPage":{"@id":"https://mlwhiz.com/blog/2019/07/21/bandits/#primaryimage"},"datePublished":"2019-07-21T00:00:00.00Z","dateModified":"2020-09-26T16:23:35.00Z","author":{"@id":"https://mlwhiz.com/about/#/schema/person/76376876bchxkzbchjsdjcca"},"description":"There are multiple ways to doing the same thing in Pandas, and that might make it troublesome for the beginner user.This post is about handling most of the data manipulation cases in Python using a straightforward, simple, and matter of fact way."},{"@type":["Person"],"@id":"https://mlwhiz.com/about/#/schema/person/76376876bchxkzbchjsdjcca","name":"Rahul Agarwal","image":{"@type":"ImageObject","@id":"https://www.mlwhiz.com/#authorlogo","url":"https://mlwhiz.com/images/author.jpg","caption":"Rahul Agarwal"},"description":"Hi there, I\u2019m Rahul Agarwal. I\u2019m a data scientist consultant and big data engineer based in Bangalore. I see a lot of times  students and even professionals wasting their time and struggling to get started with Computer Vision, Deep Learning, and NLP. I Started this Site with a purpose to augment my own understanding about new things while helping others learn about them in the best possible way.","sameAs":["https://www.linkedin.com/in/rahulagwl/","https://medium.com/@rahul_agarwal","https://twitter.com/MLWhiz","https://www.facebook.com/mlwhizblog","https://github.com/MLWhiz","https://www.instagram.com/itsmlwhiz"]}]}</script><script async data-uid=a0ebaf958d src=https://mlwhiz.ck.page/a0ebaf958d/index.js></script><script type=text/javascript async src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">MathJax.Hub.Config({tex2jax:{inlineMath:[['$','$'],['\\(','\\)']],displayMath:[['$$','$$']],processEscapes:true,processEnvironments:true,skipTags:['script','noscript','style','textarea','pre'],TeX:{equationNumbers:{autoNumber:"AMS"},extensions:["AMSmath.js","AMSsymbols.js"]}}});MathJax.Hub.Queue(function(){var all=MathJax.Hub.getAllJax(),i;for(i=0;i<all.length;i+=1){all[i].SourceElement().parentNode.className+=' has-jax';}});MathJax.Hub.Config({TeX:{equationNumbers:{autoNumber:"AMS"}}});</script><link href=//apps.shareaholic.com/assets/pub/shareaholic.js as=script><script type=text/javascript data-cfasync=false async src=//apps.shareaholic.com/assets/pub/shareaholic.js data-shr-siteid=fd1ffa7fd7152e4e20568fbe49a489d0></script></head><body><noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-NMQD44T" height=0 width=0 style=display:none;visibility:hidden></iframe></noscript><div class=preloader></div><header class=navigation><div class=container><nav class="navbar navbar-expand-lg navbar-white bg-transparent border-bottom pl-0"><a class="navbar-brand mobile-view" href=https://mlwhiz.com/><img class=img-fluid src=https://mlwhiz.com/images/logo.png alt="MLWhiz: Helping You Learn Data Science!"></a>
<button class="navbar-toggler border-0" type=button data-toggle=collapse data-target=#navigation>
<i class="ti-menu h3"></i></button><div class="collapse navbar-collapse text-center" id=navigation><div class=desktop-view><ul class="navbar-nav mr-auto"><li class=nav-item><a class=nav-link href=https://www.linkedin.com/in/rahulagwl/><i class=ti-linkedin></i></a></li><li class=nav-item><a class=nav-link href=https://medium.com/@rahul_agarwal><i class=ti-book></i></a></li><li class=nav-item><a class=nav-link href=https://twitter.com/MLWhiz><i class=ti-twitter-alt></i></a></li><li class=nav-item><a class=nav-link href=https://www.facebook.com/mlwhizblog><i class=ti-facebook></i></a></li><li class=nav-item><a class=nav-link href=https://github.com/MLWhiz><i class=ti-github></i></a></li></ul></div><a class="navbar-brand mx-auto desktop-view" href=https://mlwhiz.com/><img class=img-fluid-custom src=https://mlwhiz.com/images/logo.png alt="MLWhiz: Helping You Learn Data Science!"></a><ul class=navbar-nav><li class=nav-item><a class=nav-link href=https://mlwhiz.com/about>About</a></li><li class=nav-item><a class=nav-link href=https://mlwhiz.com/blog>Blog</a></li><li class="nav-item dropdown"><a class="nav-link dropdown-toggle" href=# role=button data-toggle=dropdown aria-haspopup=true aria-expanded=false>Topics</a><div class=dropdown-menu><a class=dropdown-item href=https://mlwhiz.com/categories/natural-language-processing>NLP</a>
<a class=dropdown-item href=https://mlwhiz.com/categories/computer-vision>Computer Vision</a>
<a class=dropdown-item href=https://mlwhiz.com/categories/deep-learning>Deep Learning</a>
<a class=dropdown-item href=https://mlwhiz.com/categories/data-science>DS/ML</a>
<a class=dropdown-item href=https://mlwhiz.com/categories/big-data>Big Data</a>
<a class=dropdown-item href=https://mlwhiz.com/categories/awesome-guides>My Best Content</a>
<a class=dropdown-item href=https://mlwhiz.com/categories/learning-resources>Learning Resources</a></div></li></ul><div class="search pl-lg-4"><button id=searchOpen class=search-btn><i class=ti-search></i></button><div class=search-wrapper><form action=https://mlwhiz.com//search class=h-100><input class="search-box px-4" id=search-query name=s type=search placeholder="Type & Hit Enter..."></form><button id=searchClose class=search-close><i class="ti-close text-dark"></i></button></div></div></div></nav></div></header><section class=section-sm><div class=container><div class=row><div class="col-lg-8 mb-5 mb-lg-0"><a href=/categories/data-science class=categoryStyle>Data Science</a><h1>Bayesian Bandits explained simply</h1><div class="mb-3 post-meta"><span>By Rahul Agarwal</span><svg class="meta__icon icon icon-time" width="16" height="14" viewBox="0 0 30 28"><path d="M15 0C7 0 1 6 1 14s6 14 14 14 14-6 14-14S23 0 15 0zm0 25C9 25 4 20 4 14S9 3 15 3s11 5 11 11-5 11-11 11zm1-18h-2v8.4l6.8 4.4L22 18l-6-3.8V7z"/></svg>
<span>21 July 2019</span></div><img src=https://mlwhiz.com/images/bandits/1.png class="img-fluid w-100 mb-4" alt="Bayesian Bandits explained simply"><div class="content mb-5"><p>Exploration and Exploitation play a key role in any business.</p><p>And any good business will try to “explore” various opportunities where it can make a profit.</p><p>Any good business at the same time also tries to focus on a particular opportunity it has found already and tries to “exploits” it.</p><p>Let me explain this further with a thought experiment.</p><p><em><strong>Thought Experiment:</strong></em> Assume that we have infinite slot machines. Every slot machine has some win probability. But we don’t know these probability values.</p><p>You have to operate these slot machines one by one. How do you come up with a strategy to maximize your outcome from these slot machines in minimum time.</p><p><img src=/images/bandits/2.png alt="MLWhiz: Data Science, Machine Learning, Artificial Intelligence"></p><p>You will most probably start by trying out some machines.</p><p>Would you stick to a particular machine that has an okayish probability(exploitation) or would you keep searching for better machines(exploration)?</p><p>It is the exploration-exploitation tradeoff.</p><p><em><strong>And the question is how do we balance this tradeoff such that we get maximum profits?</strong></em></p><p><strong>The answer is Bayesian Bandits.</strong></p><hr><h2 id=why-business-use-cases>Why? Business Use-cases:</h2><p>There are a lot of places where such a thought experiment could fit.</p><ul><li><p>AB Testing: You have a variety of assets that you can show at the website. Each asset has a particular probability of success(getting clicked by the user).</p></li><li><p>Ad Clicks: You have a variety of ads that you can show to the user. Each advert has a particular probability of clickthrough</p></li><li><p>Finance: which stock pick gives the highest return.</p></li><li><p>We as human beings are faced with the exact same problem — Explore or exploit and we handle it quite brilliantly mostly. Should we go find a new job or should we earn money doing the thing we know would give us money?</p></li></ul><p>In this post, we will focus on AB Testing but this experiment will work for any of the above problems.</p><hr><h2 id=problem-statement>Problem Statement:</h2><p><img src=/images/bandits/3.jpg alt="MLWhiz: Data Science, Machine Learning, Artificial Intelligence"></p><p>The problem we have is that we have different assets which we want to show on our awesome website but we really don’t know which one to show.</p><p>One asset is blue(B), another red(R) and the third one green(G).</p><p>Our UX team say they like the blue one. But you like the green one.</p><p>Which one to show on our website?</p><hr><h2 id=bayes-everywhere>Bayes Everywhere:</h2><p>Before we delve down into the algorithm we will use to solve this, let us revisit the Bayes theorem.</p><p><img src=/images/bandits/4.png alt="MLWhiz: Data Science, Machine Learning, Artificial Intelligence"></p><p>Just remember that Bayes theorem says that Posterior ~ likelihood*Prior</p><hr><h2 id=beta-distribution>Beta Distribution</h2><p>The <strong>beta distribution</strong> is a continuous probability distribution defined on the interval [0, 1] parametrized by two positive shape parameters, denoted by <em>α</em> and <em>β</em>.The PDF of the beta distribution is:</p><p><img src=/images/bandits/5.png alt="MLWhiz: Data Science, Machine Learning, Artificial Intelligence"></p><p>And, the pdf looks like below for different values of <em>α</em> and <em>β</em>:</p><p><img src=/images/bandits/6.png alt="MLWhiz: Data Science, Machine Learning, Artificial Intelligence"></p><p><em><strong>The beta distribution is frequently applied to model the behavior of probabilities as it lies in the range [0,1]. The beta distribution is a suitable model for the random behavior of percentages and proportions too.</strong></em></p><hr><h2 id=bayesian-bandits>Bayesian Bandits</h2><p>So after knowing the above concepts let us come back to our present problem.</p><p>We have three assets.</p><p><img src=/images/bandits/7.jpg alt="MLWhiz: Data Science, Machine Learning, Artificial Intelligence"></p><p>For the sake of this problem, let&rsquo;s assume that we know the click probabilities of these assets also.</p><p>The win probability of blue is 0.3, red is 0.8 and green is 0.4. Please note that in real life, we won’t know this.</p><p>These probabilities are going to be hidden from our algorithm and we will see how our algorithm will still converge to these real probabilities.</p><p><em><strong>So, what are our priors(beliefs) about the probability of each of these assets?</strong></em></p><p>Since we have not observed any data we cannot have prior beliefs about any of our three assets.</p><p><em><strong>We need to model our prior probabilities and we will use beta distribution to do that.</strong></em> See the curve for beta distribution above for α = 1 and β=1.</p><p>It is actually just a uniform distribution over the range [0,1]. And that is what we want for our prior probabilities for our assets. We don’t have any information yet so we start with a uniform probability distribution over our probability values.</p><p><em><strong>So we can denote the prior probabilities of each of our asset using a beta distribution.</strong></em></p><h3 id=strategy><em><strong>Strategy:</strong></em></h3><ol><li><p>We will sample a random variable from each of the 3 distributions for assets.</p></li><li><p>We will find out which random variable is maximum and will show the one asset which gave the maximum random variable.</p></li><li><p>We will get to know if that asset is clicked or not.</p></li><li><p>We will update the prior for the asset using the information in step 3.</p></li><li><p>Repeat.</p></li></ol><h3 id=updating-the-prior>Updating the Prior:</h3><p>The reason we took beta distribution to model our probabilities is because of its great mathematical properties.</p><p><img src=/images/bandits/8.png alt="MLWhiz: Data Science, Machine Learning, Artificial Intelligence"></p><p>If the prior is f(α,β), then the posterior distribution is again beta, given by f(α+#success, β+#failures)</p><p>where #success is the number of clicks and #failures are the number of views minus the number of clicks.</p><hr><h2 id=let-us-code>Let us Code</h2><p><img src=/images/bandits/9.jpg alt="MLWhiz: Data Science, Machine Learning, Artificial Intelligence"></p><p>We have every bit of knowledge we require for writing some code now. I will be using pretty much simple and standard Python functionality to do this but there exist tools like pyMC and such for this sort of problem formulations.</p><p>Let us work through this problem step by step.</p><p>We have three assets with different probabilities.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-py data-lang=py>real_probs_dict <span style=color:#f92672>=</span> {<span style=color:#e6db74>&#39;R&#39;</span>:<span style=color:#ae81ff>0.8</span>,<span style=color:#e6db74>&#39;G&#39;</span>:<span style=color:#ae81ff>0.4</span>,<span style=color:#e6db74>&#39;B&#39;</span>:<span style=color:#ae81ff>0.3</span>}
assets <span style=color:#f92672>=</span> [<span style=color:#e6db74>&#39;R&#39;</span>,<span style=color:#e6db74>&#39;G&#39;</span>,<span style=color:#e6db74>&#39;B&#39;</span>]
</code></pre></div><p>We will be trying to see if our strategy given above works or not.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-py data-lang=py><span style=color:#e6db74>&#39;&#39;&#39;
</span><span style=color:#e6db74>This function takes as input three tuples for alpha,beta that specify priorR,priorG,priorB
</span><span style=color:#e6db74>And returns R,G,B along with the maximum value sampled from these three distributions.
</span><span style=color:#e6db74>We can sample from a beta distribution using scipy.
</span><span style=color:#e6db74>&#39;&#39;&#39;</span>
<span style=color:#66d9ef>def</span> <span style=color:#a6e22e>find_asset</span>(priorR,priorG,priorB):    
    red_rv <span style=color:#f92672>=</span> scipy<span style=color:#f92672>.</span>stats<span style=color:#f92672>.</span>beta<span style=color:#f92672>.</span>rvs(priorR[<span style=color:#ae81ff>0</span>],priorR[<span style=color:#ae81ff>1</span>])
    green_rv <span style=color:#f92672>=</span> scipy<span style=color:#f92672>.</span>stats<span style=color:#f92672>.</span>beta<span style=color:#f92672>.</span>rvs(priorG[<span style=color:#ae81ff>0</span>],priorG[<span style=color:#ae81ff>1</span>])
    blue_rv <span style=color:#f92672>=</span> scipy<span style=color:#f92672>.</span>stats<span style=color:#f92672>.</span>beta<span style=color:#f92672>.</span>rvs(priorB[<span style=color:#ae81ff>0</span>],priorB[<span style=color:#ae81ff>1</span>])
    <span style=color:#66d9ef>return</span> assets[np<span style=color:#f92672>.</span>argmax([red_rv,green_rv,blue_rv])]


<span style=color:#e6db74>&#39;&#39;&#39;
</span><span style=color:#e6db74>This is a helper function that simulates the real world using the actual probability value of the assets.
</span><span style=color:#e6db74>In real life we won&#39;t have this function and our user click input will be the proxy for this function.
</span><span style=color:#e6db74>&#39;&#39;&#39;</span>
<span style=color:#66d9ef>def</span> <span style=color:#a6e22e>simulate_real_website</span>(asset, real_probs_dict):
    <span style=color:#75715e>#simulate a coin toss with probability. Asset clicked or not.</span>
    <span style=color:#66d9ef>if</span> real_probs_dict[asset]<span style=color:#f92672>&gt;</span> scipy<span style=color:#f92672>.</span>stats<span style=color:#f92672>.</span>uniform<span style=color:#f92672>.</span>rvs(<span style=color:#ae81ff>0</span>,<span style=color:#ae81ff>1</span>):
        <span style=color:#66d9ef>return</span> <span style=color:#ae81ff>1</span>
    <span style=color:#66d9ef>else</span>:
        <span style=color:#66d9ef>return</span> <span style=color:#ae81ff>0</span>

<span style=color:#e6db74>&#39;&#39;&#39;
</span><span style=color:#e6db74>This function takes as input the selected asset and returns the posteriors for the selected asset.
</span><span style=color:#e6db74>&#39;&#39;&#39;</span>
<span style=color:#66d9ef>def</span> <span style=color:#a6e22e>update_posterior</span>(asset,priorR,priorG,priorB,outcome):
    <span style=color:#66d9ef>if</span> asset<span style=color:#f92672>==</span><span style=color:#e6db74>&#39;R&#39;</span>:
        priorR<span style=color:#f92672>=</span>(priorR[<span style=color:#ae81ff>0</span>]<span style=color:#f92672>+</span>outcome,priorR[<span style=color:#ae81ff>1</span>]<span style=color:#f92672>+</span><span style=color:#ae81ff>1</span><span style=color:#f92672>-</span>outcome)
    <span style=color:#66d9ef>elif</span> asset<span style=color:#f92672>==</span><span style=color:#e6db74>&#39;G&#39;</span>:
        priorG<span style=color:#f92672>=</span>(priorG[<span style=color:#ae81ff>0</span>]<span style=color:#f92672>+</span>outcome,priorG[<span style=color:#ae81ff>1</span>]<span style=color:#f92672>+</span><span style=color:#ae81ff>1</span><span style=color:#f92672>-</span>outcome)
    <span style=color:#66d9ef>elif</span> asset<span style=color:#f92672>==</span><span style=color:#e6db74>&#39;B&#39;</span>:
        priorB<span style=color:#f92672>=</span>(priorB[<span style=color:#ae81ff>0</span>]<span style=color:#f92672>+</span>outcome,priorB[<span style=color:#ae81ff>1</span>]<span style=color:#f92672>+</span><span style=color:#ae81ff>1</span><span style=color:#f92672>-</span>outcome)
    <span style=color:#66d9ef>return</span> priorR,priorG,priorB


<span style=color:#e6db74>&#39;&#39;&#39;
</span><span style=color:#e6db74>This function runs the strategy once.
</span><span style=color:#e6db74>&#39;&#39;&#39;</span>
<span style=color:#66d9ef>def</span> <span style=color:#a6e22e>run_strategy_once</span>(priorR,priorG,priorB):
    <span style=color:#75715e># 1. get the asset</span>
    asset <span style=color:#f92672>=</span> find_asset(priorR,priorG,priorB)
    <span style=color:#75715e># 2. get the outcome from the website/users</span>
    outcome <span style=color:#f92672>=</span> simulate_real_website(asset, real_probs_dict)
    <span style=color:#75715e># 3. update prior based on outcome</span>
    priorR,priorG,priorB <span style=color:#f92672>=</span> update_posterior(asset,priorR,priorG,priorB,outcome)
    <span style=color:#66d9ef>return</span> asset,priorR,priorG,priorB

</code></pre></div><p>Let us run this strategy multiple times and collect the data.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-py data-lang=py>priorR,priorG,priorB <span style=color:#f92672>=</span> (<span style=color:#ae81ff>1</span>,<span style=color:#ae81ff>1</span>),(<span style=color:#ae81ff>1</span>,<span style=color:#ae81ff>1</span>),(<span style=color:#ae81ff>1</span>,<span style=color:#ae81ff>1</span>)
data <span style=color:#f92672>=</span> [(<span style=color:#e6db74>&#34;_&#34;</span>,priorR,priorG,priorB)]
<span style=color:#66d9ef>for</span> i <span style=color:#f92672>in</span> range(<span style=color:#ae81ff>50</span>):
    asset,priorR,priorG,priorB <span style=color:#f92672>=</span> run_strategy_once(priorR,priorG,priorB)
    data<span style=color:#f92672>.</span>append((asset,priorR,priorG,priorB))
</code></pre></div><p>This is the result of our runs. You can see the functions I used to visualize the posterior distributions here at
<a href="https://www.kaggle.com/mlwhiz/bayesian-bandits?scriptVersionId=17478592" target=_blank rel="nofollow noopener">kaggle</a>
. As you can see below, we have pretty much converged to the best asset by the end of 20 runs. And the probabilities are also estimated roughly what they should be.</p><p><em><strong>At the start, we have a uniform prior.</strong></em> As we go through with the runs we see that the “red” asset’s posterior distribution converges towards a higher mean and as such a higher probability of pick. But remember that doesn’t mean that the green asset and blue asset are not going to be picked ever.</p><p><img src=/images/bandits/10.png alt="MLWhiz: Data Science, Machine Learning, Artificial Intelligence"></p><p>Let us also see how many times each asset is picked in the 50 runs we did.</p><pre><code>Pick 1 : G ,Pick 2 : R ,Pick 3 : R ,Pick 4 : B ,Pick 5 : R ,Pick 6 : R ,Pick 7 : R ,Pick 8 : R ,Pick 9 : R ,Pick 10 : R ,Pick 11 : R ,Pick 12 : R ,Pick 13 : R ,Pick 14 : R ,Pick 15 : R ,Pick 16 : R ,Pick 17 : R ,Pick 18 : R ,Pick 19 : R ,Pick 20 : R ,Pick 21 : R ,Pick 22 : G ,Pick 23 : R ,Pick 24 : R ,Pick 25 : G ,Pick 26 : G ,Pick 27 : R ,Pick 28 : R ,Pick 29 : R ,Pick 30 : R ,Pick 31 : R ,Pick 32 : R ,Pick 33 : R ,Pick 34 : R ,Pick 35 : R ,Pick 36 : R ,Pick 37 : R ,Pick 38 : R ,Pick 39 : G ,Pick 40 : B ,Pick 41 : R ,Pick 42 : R ,Pick 43 : R ,Pick 44 : R ,Pick 45 : B ,Pick 46 : R ,Pick 47 : R ,Pick 48 : R ,Pick 49 : R ,Pick 50 : R
</code></pre><p>We can see that although we are mostly picking R we still end up sometimes picking B(Pick 45) and G(Pick 44) in the later runs too. Overall we can see that in the first few runs, we are focussing on exploration and as we go towards later runs we focus on exploitation.</p><p><img src=/images/bandits/11.png alt="MLWhiz: Data Science, Machine Learning, Artificial Intelligence"></p><h2 id=end-notes>End Notes:</h2><p>We saw how solving this problem using the Bayesian approach could help us converge to a good solution while maximizing our profit and not discarding any asset.</p><p>An added advantage of such an approach is that it is self-learning and could self-correct by itself if the probability of click on the red decreases and blue asset increases. This case might happen when the user preferences change for example.</p><p>The whole code is posted in the
<a href="https://www.kaggle.com/mlwhiz/bayesian-bandits?scriptVersionId=17478592" target=_blank rel="nofollow noopener">Kaggle Kernel</a>
.</p><p>Also, if you want to learn more about Bayesian Statistics, one of the newest and best resources that you can keep an eye on is the
<a href="https://www.coursera.org/specializations/aml?siteID=lVarvwc5BD0-AqkGMb7JzoCMW0Np1uLfCA&utm_content=2&utm_medium=partners&utm_source=linkshare&utm_campaign=lVarvwc5BD0&source=post_page---------------------------" target=_blank rel="nofollow noopener">&lt;strong>Bayesian Methods for Machine Learning&lt;/strong></a>
course in the
<a href="https://www.coursera.org/specializations/aml?siteID=lVarvwc5BD0-AqkGMb7JzoCMW0Np1uLfCA&utm_content=2&utm_medium=partners&utm_source=linkshare&utm_campaign=lVarvwc5BD0&source=post_page---------------------------" target=_blank rel="nofollow noopener">&lt;strong>Advanced machine learning specialization&lt;/strong></a></p><p>I am going to be writing more of such posts in the future too. Follow me up at
<a href="https://medium.com/@rahul_agarwal?source=post_page---------------------------" target=_blank rel="nofollow noopener">&lt;strong>Medium&lt;/strong></a>
or Subscribe to my
<a href=https://mlwhiz.ck.page/a9b8bda70c target=_blank rel="nofollow noopener">&lt;strong>blog&lt;/strong></a>
.</p><script async data-uid=8d7942551b src=https://mlwhiz.ck.page/8d7942551b/index.js></script><div class=shareaholic-canvas data-app=share_buttons data-app-id=28372088 style=margin-bottom:1px></div><a href="https://click.linksynergy.com/fs-bin/click?id=lVarvwc5BD0&offerid=467035.372&subid=0&type=4" rel=nofollow><img border=0 alt="Start your future with a Data Science Certificate." src="https://ad.linksynergy.com/fs-bin/show?id=lVarvwc5BD0&bids=467035.372&subid=0&type=4&gridnum=16"></a><div id=disqus_thread></div><script type=application/javascript>var disqus_config=function(){};(function(){if(["localhost","127.0.0.1"].indexOf(window.location.hostname)!=-1){document.getElementById('disqus_thread').innerHTML='Disqus comments not available by default when the website is previewed locally.';return;}
var d=document,s=d.createElement('script');s.async=true;s.src='//'+"mlwhiz"+'.disqus.com/embed.js';s.setAttribute('data-timestamp',+new Date());(d.head||d.body).appendChild(s);})();</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><a href=https://disqus.com class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a></div></div><div class=col-lg-4><div class=widget><script type=text/javascript src=https://ko-fi.com/widgets/widget_2.js></script><script type=text/javascript>kofiwidget2.init('Support Me on Ko-fi','#00aaa1','S6S3NPCD');kofiwidget2.draw();</script></div><div class=widget><h4 class=widget-title>About Me</h4><img src=https://mlwhiz.com/images/author.jpg alt class="img-fluid author-thumb-sm d-block mx-auto rounded-circle mb-4"><p>I’m a data scientist consultant and big data engineer based in Bangalore, where I am currently working with WalmartLabs .</p><a href=https://mlwhiz.com/about/ class="btn btn-outline-primary">Know More</a></div><div class=widget><h4 class=widget-title>Topics</h4><ul class=list-unstyled><li><a class=categoryStyle style=color:#fff href=/categories/awesome-guides>Awesome Guides</a></li><li><a class=categoryStyle style=color:#fff href=/categories/big-data>Big Data</a></li><li><a class=categoryStyle style=color:#fff href=/categories/computer-vision>Computer Vision</a></li><li><a class=categoryStyle style=color:#fff href=/categories/data-science>Data Science</a></li><li><a class=categoryStyle style=color:#fff href=/categories/deep-learning>Deep Learning</a></li><li><a class=categoryStyle style=color:#fff href=/categories/learning-resources>Learning Resources</a></li><li><a class=categoryStyle style=color:#fff href=/categories/natural-language-processing>Natural Language Processing</a></li><li><a class=categoryStyle style=color:#fff href=/categories/programming>Programming</a></li></ul></div><div class=widget><h4 class=widget-title>Tags</h4><ul class=list-inline><li class=list-inline-item><a class="tagStyle text-white" href=/tags/algorithms>Algorithms</a></li><li class=list-inline-item><a class="tagStyle text-white" href=/tags/artificial-intelligence>Artificial Intelligence</a></li><li class=list-inline-item><a class="tagStyle text-white" href=/tags/dask>Dask</a></li><li class=list-inline-item><a class="tagStyle text-white" href=/tags/deployment>Deployment</a></li><li class=list-inline-item><a class="tagStyle text-white" href=/tags/ec2>Ec2</a></li><li class=list-inline-item><a class="tagStyle text-white" href=/tags/generative-adversarial-networks>Generative Adversarial Networks</a></li><li class=list-inline-item><a class="tagStyle text-white" href=/tags/graphs>Graphs</a></li><li class=list-inline-item><a class="tagStyle text-white" href=/tags/image-classification>Image Classification</a></li><li class=list-inline-item><a class="tagStyle text-white" href=/tags/instance-segmentation>Instance Segmentation</a></li><li class=list-inline-item><a class="tagStyle text-white" href=/tags/interpretability>Interpretability</a></li><li class=list-inline-item><a class="tagStyle text-white" href=/tags/jobs>Jobs</a></li><li class=list-inline-item><a class="tagStyle text-white" href=/tags/kaggle>Kaggle</a></li><li class=list-inline-item><a class="tagStyle text-white" href=/tags/language-modeling>Language Modeling</a></li><li class=list-inline-item><a class="tagStyle text-white" href=/tags/machine-learning>Machine Learning</a></li><li class=list-inline-item><a class="tagStyle text-white" href=/tags/math>Math</a></li><li class=list-inline-item><a class="tagStyle text-white" href=/tags/multiprocessing>Multiprocessing</a></li><li class=list-inline-item><a class="tagStyle text-white" href=/tags/object-detection>Object Detection</a></li><li class=list-inline-item><a class="tagStyle text-white" href=/tags/opinion>Opinion</a></li><li class=list-inline-item><a class="tagStyle text-white" href=/tags/pandas>Pandas</a></li><li class=list-inline-item><a class="tagStyle text-white" href=/tags/production>Production</a></li><li class=list-inline-item><a class="tagStyle text-white" href=/tags/productivity>Productivity</a></li><li class=list-inline-item><a class="tagStyle text-white" href=/tags/python>Python</a></li><li class=list-inline-item><a class="tagStyle text-white" href=/tags/pytorch>Pytorch</a></li><li class=list-inline-item><a class="tagStyle text-white" href=/tags/spark>Spark</a></li><li class=list-inline-item><a class="tagStyle text-white" href=/tags/sql>Sql</a></li><li class=list-inline-item><a class="tagStyle text-white" href=/tags/statistics>Statistics</a></li><li class=list-inline-item><a class="tagStyle text-white" href=/tags/streamlit>Streamlit</a></li><li class=list-inline-item><a class="tagStyle text-white" href=/tags/text-classification>Text Classification</a></li><li class=list-inline-item><a class="tagStyle text-white" href=/tags/timeseries>Timeseries</a></li><li class=list-inline-item><a class="tagStyle text-white" href=/tags/tools>Tools</a></li><li class=list-inline-item><a class="tagStyle text-white" href=/tags/translation>Translation</a></li><li class=list-inline-item><a class="tagStyle text-white" href=/tags/visualization>Visualization</a></li><li class=list-inline-item><a class="tagStyle text-white" href=/tags/xgboost>Xgboost</a></li></ul></div><div class=widget><h4 class=widget-title>Connect With Me</h4><ul class="list-inline social-links"><li class=list-inline-item><a href=https://www.linkedin.com/in/rahulagwl/><i class=ti-linkedin></i></a></li><li class=list-inline-item><a href=https://medium.com/@rahul_agarwal><i class=ti-book></i></a></li><li class=list-inline-item><a href=https://twitter.com/MLWhiz><i class=ti-twitter-alt></i></a></li><li class=list-inline-item><a href=https://www.facebook.com/mlwhizblog><i class=ti-facebook></i></a></li><li class=list-inline-item><a href=https://github.com/MLWhiz><i class=ti-github></i></a></li></ul></div><script async data-uid=bfe9f82f10 src=https://mlwhiz.ck.page/bfe9f82f10/index.js></script><script async data-uid=3452d924e2 src=https://mlwhiz.ck.page/3452d924e2/index.js></script></div></div></div></section><footer><div class=container><div class=row><div class="col-12 text-center mb-5"><a href=https://mlwhiz.com/><img src=https://mlwhiz.com/images/logo.png class=img-fluid-custom-bottom alt="MLWhiz: Helping You Learn Data Science!"></a></div><div class="col-lg-3 col-sm-6 mb-5"><h6 class=mb-4>Contact Me</h6><ul class=list-unstyled><li class=mb-3><i class="ti-location-pin mr-3 text-primary"></i>India, Bangalore</li><li class=mb-3><a class=text-dark href=mailto:rahul@mlwhiz.com><i class="ti-email mr-3 text-primary"></i>rahul@mlwhiz.com</a></li></ul></div><div class="col-lg-3 col-sm-6 mb-5"><h6 class=mb-4>Social Contacts</h6><ul class=list-unstyled><li class=mb-3><a class=text-dark href=https://www.linkedin.com/in/rahulagwl/>Linkedin</a></li><li class=mb-3><a class=text-dark href=https://medium.com/@rahul_agarwal>Medium</a></li><li class=mb-3><a class=text-dark href=https://twitter.com/MLWhiz>Twitter</a></li><li class=mb-3><a class=text-dark href=https://www.facebook.com/mlwhizblog>Facebook</a></li><li class=mb-3><a class=text-dark href=https://github.com/MLWhiz>Github</a></li></ul></div><div class="col-lg-3 col-sm-6 mb-5"><h6 class=mb-4>Categories</h6><ul class=list-unstyled><li class=mb-3><a class=text-dark href=/categories/awesome-guides>Awesome Guides</a></li><li class=mb-3><a class=text-dark href=/categories/big-data>Big Data</a></li><li class=mb-3><a class=text-dark href=/categories/computer-vision>Computer Vision</a></li><li class=mb-3><a class=text-dark href=/categories/data-science>Data Science</a></li><li class=mb-3><a class=text-dark href=/categories/deep-learning>Deep Learning</a></li><li class=mb-3><a class=text-dark href=/categories/learning-resources>Learning Resources</a></li><li class=mb-3><a class=text-dark href=/categories/natural-language-processing>Natural Language Processing</a></li><li class=mb-3><a class=text-dark href=/categories/programming>Programming</a></li></ul></div><div class="col-lg-3 col-sm-6 mb-5"><h6 class=mb-4>Quick Links</h6><ul class=list-unstyled><li class=mb-3><a class=text-dark href=https://mlwhiz.com/about>About</a></li><li class=mb-3><a class=text-dark href=https://mlwhiz.com/blog>Post</a></li></ul></div><div class="col-12 border-top py-4 text-center">Copyright © 2020 <a href=https://mlwhiz.com>MLWhiz</a> All Rights Reserved</div></div></div></footer><script>var indexURL="https://mlwhiz.com/index.json"</script><script src=https://mlwhiz.com/plugins/compressjscss/main.js></script><script src=https://mlwhiz.com/js/script.min.js></script><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','//www.google-analytics.com/analytics.js','ga');ga('create','UA-54777926-1','auto');ga('send','pageview');</script></body></html>